import{_ as r}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o as c,c as p,a,b as s,d as n,w as t,e as o}from"./app-6706a352.js";const d={},v=a("p",null,[s("🍁"),a("strong",null,"博主简介")],-1),u={href:"https://blog.csdn.net/liu_chen_yang?type=blog",target:"_blank",rel:"noopener noreferrer"},b=a("br",null,null,-1),m={href:"https://bbs.huaweicloud.com/community/myblog",target:"_blank",rel:"noopener noreferrer"},k=a("br",null,null,-1),g={href:"https://developer.aliyun.com/my?spm=a2c6h.13148508.setting.3.21fc4f0eCmz1v3#/article?_k=zooqoz",target:"_blank",rel:"noopener noreferrer"},h=a("br",null,null,-1),_=a("strong",null,"交流社区：",-1),f={href:"https://bbs.csdn.net/forums/lcy",target:"_blank",rel:"noopener noreferrer"},y=a("h3",{id:"clamav简介",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#clamav简介","aria-hidden":"true"},"#"),s(" ClamAV简介")],-1),q=a("br",null,null,-1),$=a("br",null,null,-1),x=a("br",null,null,-1),A=a("br",null,null,-1),C=a("br",null,null,-1),w=a("br",null,null,-1),V=a("p",null,[a("strong",null,"clamav 有两个命令：clamdscan、clamscan：")],-1),I=o(`<h3 id="clamav的安装" tabindex="-1"><a class="header-anchor" href="#clamav的安装" aria-hidden="true">#</a> ClamAV的安装</h3><p>centos安装方式：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#添加扩展源</span>
yum <span class="token parameter variable">-y</span> <span class="token function">install</span> epel-release
yum <span class="token parameter variable">-y</span> <span class="token function">install</span> clamav clamavd clamav-update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ubuntu安装方式：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#升级apt源</span>
<span class="token function">apt</span> update
<span class="token function">apt</span> <span class="token parameter variable">-y</span> <span class="token function">install</span> clamav clamtk clamav-daemon clamdscan device-tree-compiler
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="更新病毒库" tabindex="-1"><a class="header-anchor" href="#更新病毒库" aria-hidden="true">#</a> 更新病毒库</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>freshclam
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412181438396.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>这样就是更新成功了；</p>`,9),D={href:"https://liucy.blog.csdn.net/article/details/129284185",target:"_blank",rel:"noopener noreferrer"},S=o(`<h3 id="clamav的使用" tabindex="-1"><a class="header-anchor" href="#clamav的使用" aria-hidden="true">#</a> ClamAV的使用</h3><h4 id="clamav的语法" tabindex="-1"><a class="header-anchor" href="#clamav的语法" aria-hidden="true">#</a> ClamAV的语法</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>clamscan <span class="token punctuation">[</span>选项/参数/简便参数<span class="token punctuation">]</span> <span class="token punctuation">[</span>文件/目录<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="clamav常用参数" tabindex="-1"><a class="header-anchor" href="#clamav常用参数" aria-hidden="true">#</a> ClamAV常用参数</h4><table><thead><tr><th>参数</th><th>简便参数</th><th>说明</th></tr></thead><tbody><tr><td>--help</td><td>-h</td><td>显示帮助页面</td></tr><tr><td>--version</td><td>-V</td><td>查看版本号</td></tr><tr><td>--verbose</td><td>-v</td><td>查看详细信息</td></tr><tr><td>--archive verbose</td><td>-a</td><td>在扫描的存档中显示文件名</td></tr><tr><td>--recursive[=yes/no(*)]</td><td>-r</td><td>递归扫描子目录，后面需跟目录</td></tr><tr><td>--infected</td><td>-i</td><td>仅打印已感染的文件</td></tr><tr><td>--log=FILE</td><td>-l</td><td>将扫描报告保存到文件中，后面需跟文件名</td></tr><tr><td>--file-list=FILE</td><td>-f</td><td>从file扫描文件，后面需跟文件名</td></tr><tr><td>--database=FILE/DIR</td><td>-d</td><td>FILE/DIR从FILE加载病毒数据库或从DIR加载所有支持的数据库文件</td></tr><tr><td>--allmatch[=yes/no(*)]</td><td>-z</td><td>找到匹配项后继续在文件中扫描</td></tr><tr><td>--quiet</td><td></td><td>仅输出错误消息</td></tr><tr><td>--tempdir=DIRECTORY</td><td></td><td>在目录中创建临时文件</td></tr><tr><td>--leave-temps[=yes/no(*)]</td><td></td><td>不删除临时文件</td></tr><tr><td>--gen-json[=yes/no(*)]</td><td></td><td>生成扫描文件的json描述并打印</td></tr><tr><td>--remove[=yes/no(*)]</td><td></td><td>删除受感染的文件，小心使用</td></tr><tr><td>--max-dir-recursion=num</td><td></td><td>目录深度，=5是扫描最高5层目录结束</td></tr></tbody></table><h4 id="clamav的用法" tabindex="-1"><a class="header-anchor" href="#clamav的用法" aria-hidden="true">#</a> ClamAV的用法</h4><h5 id="扫描病毒" tabindex="-1"><a class="header-anchor" href="#扫描病毒" aria-hidden="true">#</a> 扫描病毒</h5><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#对/data/目录扫描，并将扫描的日志放到该文件中</span>
clamscan <span class="token parameter variable">-i</span> <span class="token parameter variable">-r</span> /data/ <span class="token parameter variable">-l</span> ./clamav.log
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>-i 只显示被感染的文件</li><li>-r 扫描目录，后面需跟目录</li><li>-l 保存日志文件的位置，后面需跟文件名</li></ul><p>注意：上述命令仅扫描病毒，不会对病毒文件进行删除，需手动删除。目录越大扫描速度越慢。</p><p>扫描结果如下：</p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412181438378.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>`,12),L=o(`<blockquote><p>Known viruses      #已知病毒<br> Engine version      #发动机版本<br> Scanned directories   #扫描的目录<br> Scanned files    #扫描的文件<br> Infected files     #受感染的文件<br> Data scanned    #扫描数据<br> Data read      #数据读取<br> Time        #时间<br> Start Date      #开始日期：<br> End Date      #结束日期</p></blockquote><h5 id="扫描病毒并自动删除病毒" tabindex="-1"><a class="header-anchor" href="#扫描病毒并自动删除病毒" aria-hidden="true">#</a> 扫描病毒并自动删除病毒</h5><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#对/data/目录扫描，并将扫描的日志放到该文件中，有病毒则自动删除</span>
clamscan <span class="token parameter variable">-i</span> <span class="token parameter variable">-r</span> /data/ <span class="token parameter variable">--remove</span><span class="token operator">=</span>yes <span class="token parameter variable">-l</span> ./clamav.log
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412181438883.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>删除完可以再去哪个目录看看。</p><h5 id="创建日志保存路径" tabindex="-1"><a class="header-anchor" href="#创建日志保存路径" aria-hidden="true">#</a> 创建日志保存路径</h5><p>后续可以将病毒扫描结果保存到/var/log/clamav/ 文件夹下。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /var/log/clamav/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>扫描/home/下是否有病毒；目录越大扫描速度越慢。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>clamscan <span class="token parameter variable">-i</span> <span class="token parameter variable">-r</span> /home/ <span class="token parameter variable">-l</span> /var/log/clamav/clamav.log
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="安装配置邮件服务" tabindex="-1"><a class="header-anchor" href="#安装配置邮件服务" aria-hidden="true">#</a> 安装配置邮件服务</h2>`,11),E={href:"https://liucy.blog.csdn.net/article/details/129257050",target:"_blank",rel:"noopener noreferrer"},z=a("h2",{id:"配置定时扫描和邮件告警",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#配置定时扫描和邮件告警","aria-hidden":"true"},"#"),s(" 配置定时扫描和邮件告警")],-1),R=a("p",null,"ClamAV扫描邮件告警脚本可以选择下载也可以选择直接复制，不下载的希望多一个浏览量，谢谢蟹蟹；",-1),j={href:"https://download.csdn.net/download/liu_chen_yang/87522380",target:"_blank",rel:"noopener noreferrer"},F=a("br",null,null,-1),T=o(`<p>ClamAV扫描邮件告警脚本：</p><blockquote><p>ClamAV病毒扫描之邮件告警脚本，里面内容可根据自己的情况自行修改。<br> 自行修改的内容有：<br>   mail 邮件收件人<br>   要扫描的路径（默认为/根目录）<br>   日志存储的路径（默认为/var/log/clamav/）<br><br>   还有就是最后的if判断那边也要记得修改自己的邮件收件人，判断三个都要改。<br>   如果是一个人的话，可以直接写邮箱地址；如果是多个人的话在判断后面改为$mail_A，然后把需要通知的人写到最上面的mail_A环境变量中</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
freshclam   <span class="token comment">##病毒库更新</span>

<span class="token assign-left variable">mail_A</span><span class="token operator">=</span><span class="token punctuation">(</span>mail1@qq.com,mail2@qq.com,mail3@163.com<span class="token punctuation">)</span> <span class="token comment">## 邮件收件人，可批量</span>

<span class="token comment"># 获取当前时间（用于创建、读取日志文件）</span>
<span class="token assign-left variable">date</span><span class="token operator">=</span><span class="token variable"><span class="token variable">\`</span><span class="token function">date</span> +%Y%m%d-%H:%M:%S<span class="token variable">\`</span></span>

<span class="token comment"># *填写扫描路径（可根据自己的情况来自定义，默认为/根目录）</span>
<span class="token assign-left variable">clpath</span><span class="token operator">=</span><span class="token string">&quot;/&quot;</span>

<span class="token comment"># *填写要存储日志的路径（可根据自己的情况来自定义，默认为/var/log/clamav/）</span>
<span class="token assign-left variable">clamav_log</span><span class="token operator">=</span><span class="token string">&quot;/var/log/clamav&quot;</span>


<span class="token comment"># 判断是否有存储日志的目录，如果没有则先创建，为了下面的存放日志而创建</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-e</span> <span class="token variable">$clamav_log</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;有这个目录&quot;</span> <span class="token operator">&gt;</span> /dev/null
<span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;没有这个目录&quot;</span> <span class="token operator">&gt;</span> /dev/null
        <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$clamav_log</span>
<span class="token keyword">fi</span>

<span class="token comment">#扫描/目录 结果打印到$clamav_log/clamav$date.log</span>
clamscan <span class="token parameter variable">-r</span> <span class="token parameter variable">-i</span> <span class="token variable">$clpath</span> <span class="token parameter variable">-l</span> <span class="token variable">$clamav_log</span>/clamav<span class="token variable">$date</span>.log
<span class="token comment">#删除WARING开头的内容</span>
<span class="token function">sed</span> <span class="token parameter variable">-i</span>  <span class="token string">&#39;/^WARNING/d&#39;</span> <span class="token variable">$clamav_log</span>/clamav<span class="token variable">$date</span>.log
<span class="token comment">#删除第一行到第三行的内容</span>
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;1,3d&#39;</span> <span class="token variable">$clamav_log</span>/clamav<span class="token variable">$date</span>.log

<span class="token comment">##获取当前服务器ip ，可以先执行这条命令看看自己的ip对不对。</span>
<span class="token assign-left variable">ip</span><span class="token operator">=</span><span class="token variable"><span class="token variable">\`</span><span class="token function">hostname</span> <span class="token parameter variable">-I</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token parameter variable">-F</span> <span class="token string">&quot; &quot;</span> <span class="token string">&#39;{print $1}&#39;</span><span class="token variable">\`</span></span>
<span class="token comment">#echo $IP</span>

<span class="token assign-left variable">data_log</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
<span class="token keyword">while</span> <span class="token builtin class-name">read</span> line
<span class="token keyword">do</span>
<span class="token comment">#  data_log+=$line&quot;&lt;br&gt;&quot;</span>
  <span class="token assign-left variable">data_log</span><span class="token operator">+=</span><span class="token variable">$line</span><span class="token string">&quot;<span class="token entity" title="\\n">\\n</span>&quot;</span>
<span class="token keyword">done</span> <span class="token operator">&lt;</span> <span class="token variable">$clamav_log</span>/clamav<span class="token variable">$date</span>.log

<span class="token comment">##获取高危病毒的个数</span>
<span class="token assign-left variable">infected_files</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> $clamav_log/clamav$date.log <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;Infected files&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token parameter variable">-F</span> <span class="token string">&quot;: &quot;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">)</span></span>
<span class="token comment">##获取执行时的时间</span>
<span class="token assign-left variable">scan_time</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> $clamav_log/clamav$date.log <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;Start Date&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token parameter variable">-F</span> <span class="token string">&quot;: &quot;</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">)</span></span>

<span class="token assign-left variable">data_log</span><span class="token operator">=</span><span class="token variable">\${data_log<span class="token operator">/</span>SCAN SUMMARY<span class="token operator">/</span>扫描结果}</span>
<span class="token assign-left variable">data_log</span><span class="token operator">=</span><span class="token variable">\${data_log<span class="token operator">/</span>Known viruses<span class="token operator">/</span>病毒库数量}</span>
<span class="token assign-left variable">data_log</span><span class="token operator">=</span><span class="token variable">\${data_log<span class="token operator">/</span>Engine version<span class="token operator">/</span>引擎版本}</span> 
<span class="token assign-left variable">data_log</span><span class="token operator">=</span><span class="token variable">\${data_log<span class="token operator">/</span>Scanned directories<span class="token operator">/</span>已扫描目录}</span> 
<span class="token assign-left variable">data_log</span><span class="token operator">=</span><span class="token variable">\${data_log<span class="token operator">/</span>Scanned files<span class="token operator">/</span>已扫描文件}</span> 
<span class="token assign-left variable">data_log</span><span class="token operator">=</span><span class="token variable">\${data_log<span class="token operator">/</span>Infected files<span class="token operator">/</span>已发现病毒文件}</span> 
<span class="token assign-left variable">data_log</span><span class="token operator">=</span><span class="token variable">\${data_log<span class="token operator">/</span>Total errors<span class="token operator">/</span>错误总数}</span>
<span class="token assign-left variable">data_log</span><span class="token operator">=</span><span class="token variable">\${data_log<span class="token operator">/</span>Data scanned<span class="token operator">/</span>已扫描数据}</span> 
<span class="token assign-left variable">data_log</span><span class="token operator">=</span><span class="token variable">\${data_log<span class="token operator">/</span>Data read<span class="token operator">/</span>读取数据}</span> 
<span class="token assign-left variable">data_log</span><span class="token operator">=</span><span class="token variable">\${data_log<span class="token operator">/</span>Time<span class="token operator">/</span>扫描时长}</span> 
<span class="token assign-left variable">data_log</span><span class="token operator">=</span><span class="token variable">\${data_log<span class="token operator">/</span>Start Date<span class="token operator">/</span>开始时间}</span> 
<span class="token assign-left variable">data_log</span><span class="token operator">=</span><span class="token variable">\${data_log<span class="token operator">/</span>End Date<span class="token operator">/</span>结束时间}</span> 


<span class="token assign-left variable">body</span><span class="token operator">=</span><span class="token string">&quot;杀毒软件 ClamAV 在<span class="token variable">$scan_time</span>   对您的服务器<span class="token variable">$ip</span>进行了扫描，扫描的路径为：<span class="token variable">$clpath</span>，扫描结果：暂未发现病毒！&quot;</span>
<span class="token assign-left variable">body2</span><span class="token operator">=</span><span class="token string">&quot;杀毒软件 ClamAV 在<span class="token variable">$scan_time</span>   对您的服务器<span class="token variable">$ip</span>进行了扫描,扫描的路径为：<span class="token variable">$clpath</span>，扫描结果：发现有<span class="token variable">$infected_files</span>个高危病毒 ；请立即登录服务器处理！详情可见附件↓ &quot;</span>

<span class="token assign-left variable">log2</span><span class="token operator">=</span><span class="token string">&quot;杀毒软件 ClamAV 在<span class="token variable">$scan_time</span>   对您的服务器<span class="token variable">$ip</span>进行了扫描,扫描的路径为：<span class="token variable">$clpath</span>，扫描结果：发现有<span class="token variable">$infected_files</span>个高危病毒 ；病毒为：<span class="token entity" title="\\n">\\n</span><span class="token variable">$data_log</span><span class="token entity" title="\\n">\\n</span>请立即登录服务器处理！！！&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token variable">$log2</span>&quot;</span> <span class="token operator">&gt;</span> ./<span class="token variable">\${ip}</span>_clamav.txt

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$infected_files</span>&quot;</span> <span class="token parameter variable">-eq</span> <span class="token string">&quot;0&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	<span class="token builtin class-name">echo</span> <span class="token variable">$body</span> <span class="token operator">|</span> mail <span class="token parameter variable">-s</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token variable">$ip</span> <span class="token entity" title="\\r">\\r</span>服务器病毒处理通知-无病毒&quot;</span><span class="token variable">)</span></span>&quot;</span>  mail1@qq.com
<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$infected_files</span>&quot;</span> <span class="token parameter variable">-gt</span> <span class="token string">&quot;0&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	<span class="token builtin class-name">echo</span> <span class="token variable">$body2</span> <span class="token operator">|</span> mail <span class="token parameter variable">-a</span> ./<span class="token variable">\${ip}</span>_clamav.txt <span class="token parameter variable">-s</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token variable">$ip</span> <span class="token entity" title="\\r">\\r</span>服务器病毒处理通知-有 <span class="token variable">$infected_files</span> 个高危病毒&quot;</span><span class="token variable">)</span></span>&quot;</span>  mail1@qq.com
<span class="token keyword">else</span>
	<span class="token builtin class-name">echo</span> <span class="token variable">$body2</span> <span class="token operator">|</span> mail <span class="token parameter variable">-s</span> <span class="token string">&quot;<span class="token variable">$ip</span> :此次查询失败，请检查日志！&quot;</span> mail1@qq.com
<span class="token keyword">fi</span>

<span class="token comment">#$mail_A  ##收件人地址</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),N=o('<h3 id="发送邮件告警样式演示" tabindex="-1"><a class="header-anchor" href="#发送邮件告警样式演示" aria-hidden="true">#</a> 发送邮件告警样式演示：</h3><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412181438162.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>显示内容：</strong></p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412181438066.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412181438147.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="删除病毒方式" tabindex="-1"><a class="header-anchor" href="#删除病毒方式" aria-hidden="true">#</a> 删除病毒方式</h3><blockquote><p>方式一：扫描到病毒可以手动删除，进入病毒目录直接删除就可以；<br>  <br> 方式二：也可以找到病毒目录，再次执行扫描病毒命令并指定病毒所在目录，<code>clamscan -i -r /data/ --remove=yes -l ./clamav.log</code> 来实现删除病毒；</p></blockquote><h3 id="配置定时扫描" tabindex="-1"><a class="header-anchor" href="#配置定时扫描" aria-hidden="true">#</a> 配置定时扫描</h3><p>配置定时扫描也就是设置周期性计划任务</p>',9),M=a("p",null,[s("如果是只扫描某一个路径下的，可以一天扫一次就行；"),a("br"),s(" 如果是直接扫根目录，建议一周扫一次。")],-1),P=o(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">vim</span> /etc/crontab

<span class="token comment">#以用户root身份定时执行脚本，sh为执行命令，/data/----为脚本绝对路径；每天凌晨4点扫描一次</span>
<span class="token number">0</span> <span class="token number">4</span> * * * root /bin/sh /data/clamav/clamav.sh

<span class="token comment">###每周日凌晨1点clamav扫描漏洞（扫描根目录推荐）</span>
<span class="token number">0</span> <span class="token number">1</span> * * <span class="token number">7</span>   root /bin/sh /home/clamav/clamav.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412181438417.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412181438711.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>配置完成之后保存退出即可。</p><h3 id="附加-升级clamav报错解决方式及相关文章" tabindex="-1"><a class="header-anchor" href="#附加-升级clamav报错解决方式及相关文章" aria-hidden="true">#</a> 附加：升级ClamAV报错解决方式及相关文章</h3>`,5),B=a("thead",null,[a("tr",null,[a("th",{style:{"text-align":"left"}},"文章名"),a("th",{style:{"text-align":"left"}},"文章链接🔗")])],-1),O={style:{"text-align":"left"}},G={href:"https://liucy.blog.csdn.net/article/details/129284185",target:"_blank",rel:"noopener noreferrer"},H={style:{"text-align":"left"}},K={href:"https://liucy.blog.csdn.net/article/details/129284185",target:"_blank",rel:"noopener noreferrer"},W={style:{"text-align":"left"}},Y={href:"https://liucy.blog.csdn.net/article/details/129257050",target:"_blank",rel:"noopener noreferrer"},Z={style:{"text-align":"left"}},U={href:"https://liucy.blog.csdn.net/article/details/129257050",target:"_blank",rel:"noopener noreferrer"},X={style:{"text-align":"left"}},J={href:"https://download.csdn.net/download/liu_chen_yang/87522380",target:"_blank",rel:"noopener noreferrer"},Q={style:{"text-align":"left"}},aa={href:"https://download.csdn.net/download/liu_chen_yang/87522380",target:"_blank",rel:"noopener noreferrer"};function sa(na,ea){const e=i("ExternalLinkIcon"),l=i("font");return c(),p("div",null,[a("blockquote",null,[v,a("p",null,[s("  🏅"),a("a",u,[s("云计算领域优质创作者"),n(e)]),b,s("   🏅"),a("a",m,[s("华为云开发者社区专家博主"),n(e)]),k,s("   🏅"),a("a",g,[s("阿里云开发者社区专家博主"),n(e)]),h,s(" 💊"),_,a("a",f,[s("运维交流社区"),n(e)]),s(" 欢迎大家的加入！")])]),y,a("blockquote",null,[a("p",null,[s("ClamAV是Linux操作系统一款"),n(l,{color:"green"},{default:t(()=>[s("免费的杀毒工具")]),_:1}),s("，可以通过命令执行病毒库升级、查找病毒和删除病毒。"),n(l,{color:"green"},{default:t(()=>[s("ClamAV属于免费开源产品，支持多种平台，如：Linux/Unix、MAC OS X、Windows、OpenVMS。")]),_:1}),q,s("  "),$,s(" ClamAV是基于病毒扫描的命令行工具，但同时也有支持图形界面的ClamTK工具。"),x,s("  "),A,s(" ClamAV主要用于邮件服务器扫描邮件。它有多种接口从邮件服务器扫描邮件，支持文件格式有如：ZIP、RAR、TAR、GZIP、BZIP2、HTML、DOC、PDF,、SIS CHM、RTF等等。"),C,s("  "),w,s(" ClamAV可以自动升级病毒库，还可以从共享库中运行。")])]),V,a("ul",null,[a("li",null,[s("clamscan 命令：通用，"),n(l,{color:"orange"},{default:t(()=>[s("不依赖服务")]),_:1}),s("，命令参数较多，"),n(l,{color:"red"},{default:t(()=>[s("执行速度稍慢")]),_:1})]),a("li",null,[s("clamdscan 命令：是一个"),n(l,{color:"orange"},{default:t(()=>[s("搭配clamd常驻服务")]),_:1}),s("的扫毒工具，功能非常类似clamscan，"),n(l,{color:"green"},{default:t(()=>[s("执行效率较高")]),_:1}),s("，但是可用的参数较少（因为部分功能是由 clamd 控制的）。"),n(l,{color:"red"},{default:t(()=>[s("不用带 -r ，默认会递归扫描子目录")]),_:1})])]),I,n(l,{color:"red"},{default:t(()=>[s("如遇到报错，可参考报错： ")]),_:1}),s(),a("a",D,[s("clamav升级问题报错2：Can‘t query current.cvd.clamav.net"),n(e)]),S,a("p",null,[s("这种的是没有病毒；"),n(l,{color:"red"},{default:t(()=>[s("Infected files")]),_:1}),s(" 显示0，则没有扫到病毒，1或其他则扫出了病毒。")]),L,a("p",null,[s("安装邮件服务可参考： "),a("a",E,[s("【Linux】部署mailx服务及发送邮件告警"),n(e)])]),z,R,a("p",null,[s("ClamAV扫描邮件告警脚本："),a("a",j,[s("ClamAV病毒扫描之邮件告警脚本"),F,n(e)])]),T,n(l,{color:"red"},{default:t(()=>[s("注：该脚本只适用于clamscan命令，并不适用于clamdscan命令。")]),_:1}),N,a("blockquote",null,[n(l,{color:"red"},{default:t(()=>[s("提示：")]),_:1}),M]),P,a("table",null,[B,a("tbody",null,[a("tr",null,[a("td",O,[a("a",G,[s("clamav升级问题报错2：Can‘t query current.cvd.clamav.net"),n(e)])]),a("td",H,[a("a",K,[s("https://liucy.blog.csdn.net/article/details/129284185"),n(e)])])]),a("tr",null,[a("td",W,[a("a",Y,[s("【Linux】部署mailx服务及发送邮件告警"),n(e)])]),a("td",Z,[a("a",U,[s("https://liucy.blog.csdn.net/article/details/129257050"),n(e)])])]),a("tr",null,[a("td",X,[a("a",J,[s("ClamAV病毒扫描之邮件告警脚本"),n(e)])]),a("td",Q,[a("a",aa,[s("https://download.csdn.net/download/liu_chen_yang/87522380"),n(e)])])])])])])}const oa=r(d,[["render",sa],["__file","【Linux】安装杀毒软件(漏洞扫描工具)ClamAV 并配置邮件告警操作指南.html.vue"]]);export{oa as default};
