import{_ as l}from"./plugin-vue_export-helper-c27b6911.js";import{r as p,o as c,c as u,d as a,w as i,a as n,b as s,e as o}from"./app-6706a352.js";const r={},d=n("figure",null,[n("img",{src:"https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161017672.jpeg",alt:"",tabindex:"0",loading:"lazy"}),n("figcaption")],-1),g=n("br",null,null,-1),b=n("br",null,null,-1),k={href:"https://liucy.blog.csdn.net/article/details/124248236",target:"_blank",rel:"noopener noreferrer"},m=n("br",null,null,-1),h=n("hr",null,null,-1),v={href:"https://download.csdn.net/download/liu_chen_yang/86168600",target:"_blank",rel:"noopener noreferrer"},y=n("br",null,null,-1),f=n("hr",null,null,-1),_=n("p",null,"zabbix5.0è®¾ç½®ä¼ä¸šå¾®ä¿¡å‘Šè­¦ï¼Œé¦–å…ˆéœ€è¦ä¸€ä¸ªä¼ä¸šå¾®ä¿¡ï¼›",-1),x=n("h2",{id:"ä¸€ã€é…ç½®ä¼ä¸šå¾®ä¿¡",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ä¸€ã€é…ç½®ä¼ä¸šå¾®ä¿¡","aria-hidden":"true"},"#"),s(" ä¸€ã€é…ç½®ä¼ä¸šå¾®ä¿¡")],-1),z=n("h3",{id:"_1ã€æ³¨å†Œä¼ä¸šå¾®ä¿¡",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_1ã€æ³¨å†Œä¼ä¸šå¾®ä¿¡","aria-hidden":"true"},"#"),s(" 1ã€æ³¨å†Œä¼ä¸šå¾®ä¿¡")],-1),q=n("blockquote",null,[n("p",null,"å¦‚æœæ˜¯åœ¨å…¬å¸ï¼Œç›‘æ§è‡ªå®šä¹‰æœåŠ¡ï¼Œéœ€è¦éƒ¨åˆ†çš„äººå‘˜éƒ½èƒ½çœ‹åˆ°ï¼Œå“ªæœ€å¥½å°±æ˜¯å»æ‰¾å…¬å¸ä¼ä¸šå¾®ä¿¡çš„åˆ›å»ºäººï¼Œå› ä¸ºåé¢ä¼šç”¨åˆ°ä¼ä¸šIDã€‚")],-1),j={href:"https://work.weixin.qq.com/",target:"_blank",rel:"noopener noreferrer"},w=n("figure",null,[n("img",{src:"https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161017203.png",alt:"",tabindex:"0",loading:"lazy"}),n("figcaption")],-1),I=n("p",null,"ä¼ä¸šåç§°å¯å¡«å†™ä¼ä¸šã€æ”¿åºœæˆ–ç»„ç»‡åç§°",-1),C=n("figure",null,[n("img",{src:"https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161017732.png",alt:"",tabindex:"0",loading:"lazy"}),n("figcaption")],-1),S=n("p",null,"å¡«å†™å®Œæˆä¹‹åç‚¹å‡»æ³¨å†Œå°±å¯ä»¥äº†ï¼›",-1),V=n("figure",null,[n("img",{src:"https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161017277.png",alt:"",tabindex:"0",loading:"lazy"}),n("figcaption")],-1),D=n("br",null,null,-1),E=o(`<h3 id="_2ã€æ·»åŠ éƒ¨é—¨" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ éƒ¨é—¨" aria-hidden="true">#</a> 2ã€æ·»åŠ éƒ¨é—¨</h3><p><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161017194.png" alt="" loading="lazy"><br><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161017100.png" alt="" loading="lazy"><br><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016453.png" alt="" loading="lazy"></p><p>æ·»åŠ å®Œéƒ¨é—¨çœ‹ä¸€ä¸‹éƒ¨é—¨Idï¼Œåé¢å†™é…ç½®çš„æ—¶å€™è¦ç”¨åˆ°ã€‚</p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016654.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_3ã€æ·»åŠ éƒ¨é—¨æˆå‘˜" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ éƒ¨é—¨æˆå‘˜" aria-hidden="true">#</a> 3ã€æ·»åŠ éƒ¨é—¨æˆå‘˜</h3><blockquote><p>å¯ä»¥æ–‡ä»¶å¯¼å…¥ï¼Œä¹Ÿå¯ä»¥ä»å…¶ä»–éƒ¨é—¨ç§»å…¥ï¼Œä¹Ÿå¯ä»¥è‡ªå·±æ·»åŠ æˆå‘˜ã€‚</p></blockquote><p>æˆ‘ä»¬å°±æ¥è‡ªå·±æ·»åŠ å§ï¼›</p><p><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016038.png" alt="" loading="lazy"><br><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016744.png" alt="" loading="lazy"></p><p>å®Œæˆä¹‹åå¯ç»§ç»­æ·»åŠ ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¿å­˜ï¼›</p><p><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016492.png" alt="" loading="lazy"><br><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016859.png" alt="" loading="lazy"></p><h3 id="_4ã€è‡ªå»ºåº”ç”¨-ç”¨æ¥å‘Šè­¦é€šçŸ¥çš„" tabindex="-1"><a class="header-anchor" href="#_4ã€è‡ªå»ºåº”ç”¨-ç”¨æ¥å‘Šè­¦é€šçŸ¥çš„" aria-hidden="true">#</a> 4ã€è‡ªå»ºåº”ç”¨ï¼ˆç”¨æ¥å‘Šè­¦é€šçŸ¥çš„ï¼‰</h3><p>é€‰æ‹©åº”ç”¨ç®¡ç†----&gt;é€‰æ‹©è‡ªå»ºåº”ç”¨ï¼ˆæ”¯æŒå°ç¨‹åºï¼‰</p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016430.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>åˆ›å»ºåº”ç”¨ï¼›</p><blockquote><ul><li>â€ƒlogoå¯ä»¥è‡ªå·±å»ç½‘ä¸ŠæŸ¥æ‰¾æˆ–è€…è‡ªå·±åšä¸€ä¸ªï¼›</li><li>â€ƒåº”ç”¨åç§°å¯ä»¥è‡ªå·±å®šä¹‰ï¼Œæˆ‘å®šä¹‰çš„å°±æ˜¯â€zabbixç›‘æ§â€œï¼›</li><li>â€ƒåº”ç”¨ä»‹ç»å¯ä»¥ä¸å¡«ï¼Œçœ‹è‡ªå·±æƒ…å†µï¼›</li><li>â€ƒå¯è§èŒƒå›´ï¼Œé€‰æ‹©åˆšåˆšåˆ›å»ºçš„éƒ¨é—¨å³å¯ã€‚</li></ul></blockquote><p><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016360.png" alt="" loading="lazy"><br><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016889.png" alt="" loading="lazy"></p><p>åˆ›å»ºæˆåŠŸæŸ¥çœ‹</p><blockquote><p>â€ƒâ€ƒè¦è®°ä½idï¼Œåç»­è¿˜éœ€è¦secretï¼Œåˆ°æ—¶å€™æŸ¥çœ‹æŒ‰ç…§æ­¥éª¤åšå°±å¯ä»¥äº†ã€‚</p></blockquote><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016559.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ç‚¹å‡»æŸ¥çœ‹Secret</p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016970.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ç‚¹å‡»å‘é€ååœ¨ä¼ä¸šå¾®ä¿¡å†…ä¼šæœ‰ä¿¡æ¯ï¼Œç‚¹å‡»æŸ¥çœ‹Secret</p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016634.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ç‚¹å‡»å‰å¾€æŸ¥çœ‹ï¼›è®°ä¸‹æ¥ï¼Œåç»­è¦ç”¨åˆ°ï¼›</p><p><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016977.png" alt="" loading="lazy"><br> é¡ºä¾¿æŸ¥çœ‹ä¸€ä¸‹ä¼ä¸šçš„IDï¼Œåç»­éœ€è¦ç”¨åˆ°ï¼›</p><blockquote><p>â€ƒâ€ƒç‚¹å‡»æˆ‘çš„ä¼ä¸š---&gt;ä¼ä¸šä¿¡æ¯---&gt;æœ€ä¸‹é¢æœ‰ä¸€ä¸ªä¼ä¸šIDï¼›ï¼ˆè¿™ä¸ªæ˜¯éœ€è¦è®°ä½çš„ï¼Œåç»­è¦ä½¿ç”¨ï¼‰ã€‚</p></blockquote><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016841.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="äºŒã€é…ç½®zabbixæœåŠ¡ç«¯-zabbix-server" tabindex="-1"><a class="header-anchor" href="#äºŒã€é…ç½®zabbixæœåŠ¡ç«¯-zabbix-server" aria-hidden="true">#</a> äºŒã€é…ç½®zabbixæœåŠ¡ç«¯ï¼ˆzabbix-serverï¼‰</h2><br><h3 id="_1ã€ç¼–è¾‘zabbix-server-confæ–‡ä»¶è¿›è¡Œé…ç½®" tabindex="-1"><a class="header-anchor" href="#_1ã€ç¼–è¾‘zabbix-server-confæ–‡ä»¶è¿›è¡Œé…ç½®" aria-hidden="true">#</a> 1ã€ç¼–è¾‘zabbix-server.confæ–‡ä»¶è¿›è¡Œé…ç½®</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#è¿›å…¥zabbix_serveré…ç½®æ–‡ä»¶</span>
<span class="token function">vim</span> /etc/zabbix/zabbix_server.conf

<span class="token comment">#é»˜è®¤523è¡Œä¼šæœ‰è¿™æ¡ï¼Œè¿™é‡Œæ˜¯å­˜æ”¾è„šæœ¬çš„ä½ç½®</span>
<span class="token assign-left variable">AlertScriptsPath</span><span class="token operator">=</span>/usr/lib/zabbix/alertscripts
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2ã€å®‰è£…ç»„ä»¶requests" tabindex="-1"><a class="header-anchor" href="#_2ã€å®‰è£…ç»„ä»¶requests" aria-hidden="true">#</a> 2ã€å®‰è£…ç»„ä»¶requests</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>yum <span class="token parameter variable">-y</span> <span class="token function">install</span> python-requests
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_3ã€å¾®ä¿¡æŠ¥è­¦è„šæœ¬" tabindex="-1"><a class="header-anchor" href="#_3ã€å¾®ä¿¡æŠ¥è­¦è„šæœ¬" aria-hidden="true">#</a> 3ã€å¾®ä¿¡æŠ¥è­¦è„šæœ¬</h3>`,34),N={href:"https://download.csdn.net/download/liu_chen_yang/86087478",target:"_blank",rel:"noopener noreferrer"},T=o(`<p>åœ¨/usr/lib/zabbix/alertscriptsç›®å½•ä¸‹æ“ä½œï¼›</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#è¿›å…¥/usr/lib/zabbix/alertscripts</span>
<span class="token builtin class-name">cd</span> /usr/lib/zabbix/alertscripts
<span class="token comment">#åˆ›å»ºä¸€ä¸ªpythonè„šæœ¬</span>
<span class="token function">vim</span> weixin.py
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¤åˆ¶ä¸‹é¢çš„è„šæœ¬ç²˜è´´ä¸Šå»å³å¯ï¼›</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/python</span>
<span class="token comment">#_*_coding:utf-8 _*_</span>
 
 
<span class="token keyword">import</span> urllib<span class="token punctuation">,</span>urllib2
<span class="token keyword">import</span> json
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> simplejson
<span class="token keyword">import</span> base64
<span class="token keyword">import</span> hashlib
 
<span class="token builtin">reload</span><span class="token punctuation">(</span>sys<span class="token punctuation">)</span>
sys<span class="token punctuation">.</span>setdefaultencoding<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
 
 
<span class="token keyword">def</span> <span class="token function">gettoken</span><span class="token punctuation">(</span>corpid<span class="token punctuation">,</span>corpsecret<span class="token punctuation">)</span><span class="token punctuation">:</span>
    gettoken_url <span class="token operator">=</span> <span class="token string">&#39;https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=&#39;</span> <span class="token operator">+</span> corpid <span class="token operator">+</span> <span class="token string">&#39;&amp;corpsecret=&#39;</span> <span class="token operator">+</span> corpsecret
    <span class="token keyword">print</span>  gettoken_url
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        token_file <span class="token operator">=</span> urllib2<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>gettoken_url<span class="token punctuation">)</span>
    <span class="token keyword">except</span> urllib2<span class="token punctuation">.</span>HTTPError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span> e<span class="token punctuation">.</span>code
        <span class="token keyword">print</span> e<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&quot;utf8&quot;</span><span class="token punctuation">)</span>
        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    token_data <span class="token operator">=</span> token_file<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
    token_json <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>token_data<span class="token punctuation">)</span>
    token_json<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span>
    token <span class="token operator">=</span> token_json<span class="token punctuation">[</span><span class="token string">&#39;access_token&#39;</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span>
    <span class="token keyword">return</span> token
 
<span class="token keyword">def</span> <span class="token function">senddata</span><span class="token punctuation">(</span>access_token<span class="token punctuation">,</span>user<span class="token punctuation">,</span>subject<span class="token punctuation">,</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;/usr/lib/zabbix/alertscripts/graph/bg.png&#39;</span><span class="token punctuation">,</span>mode<span class="token operator">=</span><span class="token string">&#39;rb&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
       png <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    png_md5 <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>
    png_64 <span class="token operator">=</span> base64<span class="token punctuation">.</span>b16encode<span class="token punctuation">(</span>png<span class="token punctuation">)</span>
    send_url <span class="token operator">=</span> <span class="token string">&#39;https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=&#39;</span> <span class="token operator">+</span> access_token
    send_values <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;touser&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;@all&quot;</span><span class="token punctuation">,</span>   <span class="token comment">#ä¼ä¸šå·ä¸­çš„ç”¨æˆ·å¸å·ï¼Œåœ¨zabbixç”¨æˆ·Mediaä¸­é…ç½®ï¼Œå¦‚æœé…ç½®ä¸æ­£å¸¸ï¼Œå°†æŒ‰éƒ¨é—¨å‘é€ã€‚</span>
        <span class="token string">&quot;toparty&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span>    <span class="token comment">#ä¼ä¸šå·ä¸­çš„éƒ¨é—¨idã€‚</span>
        <span class="token string">&quot;msgtype&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span> <span class="token comment">#æ¶ˆæ¯ç±»å‹ã€‚</span>
        <span class="token string">&quot;agentid&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;100035&quot;</span><span class="token punctuation">,</span>    <span class="token comment">#ä¼ä¸šå·ä¸­çš„åº”ç”¨idã€‚</span>
        <span class="token string">&quot;text&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span>
            <span class="token string">&quot;content&quot;</span><span class="token punctuation">:</span>subject <span class="token operator">+</span> <span class="token string">&#39;\\n&#39;</span> <span class="token operator">+</span> content
           <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;safe&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;0&quot;</span>
        <span class="token punctuation">}</span>
        
<span class="token comment">#    send_data = json.dumps(send_values, ensure_ascii=False)</span>
    send_data <span class="token operator">=</span> simplejson<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>send_values<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span>
    send_request <span class="token operator">=</span> urllib2<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>send_url<span class="token punctuation">,</span> send_data<span class="token punctuation">)</span>
    response <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>urllib2<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>send_request<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token builtin">str</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>
 
 
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    user <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>     <span class="token comment">#zabbixä¼ è¿‡æ¥çš„ç¬¬ä¸€ä¸ªå‚æ•°</span>
    subject <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">#zabbixä¼ è¿‡æ¥çš„ç¬¬äºŒä¸ªå‚æ•°</span>
    content <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">#zabbixä¼ è¿‡æ¥çš„ç¬¬ä¸‰ä¸ªå‚æ•°</span>
 
    corpid <span class="token operator">=</span>  <span class="token string">&#39;22jsaooasbf23934&#39;</span>   <span class="token comment">#CorpIDæ˜¯ä¼ä¸šå·çš„æ ‡è¯†</span>
    corpsecret <span class="token operator">=</span> <span class="token string">&#39;410Jsk8_4lvCQYmdo92-sdfafsadfasdfxzc&#39;</span>  <span class="token comment">#corpsecretSecretæ˜¯ç®¡ç†ç»„å‡­è¯å¯†é’¥</span>
    accesstoken <span class="token operator">=</span> gettoken<span class="token punctuation">(</span>corpid<span class="token punctuation">,</span>corpsecret<span class="token punctuation">)</span>
    senddata<span class="token punctuation">(</span>accesstoken<span class="token punctuation">,</span>user<span class="token punctuation">,</span>subject<span class="token punctuation">,</span>content<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„é‡Œé¢è¦ä¿®æ”¹çš„åœ°æ–¹ï¼›ï¼ˆä¸Šé¢è¯´è¿‡äº†å‡ å¤„åœ°æ–¹æ˜¯éœ€è¦æ³¨æ„çš„åé¢éœ€è¦ç”¨åˆ°ï¼Œç°åœ¨å°±å¯ä»¥ç”¨åˆ°äº†ï¼‰ï¼›</p><blockquote><p>éœ€è¦ä¿®æ”¹çš„åœ°æ–¹æœ‰ï¼š<br><br></p><ul><li>ç¬¬40è¡Œ:â€ƒ &quot;toparty&quot;:&quot;2&quot;, #ä¼ä¸šéƒ¨é—¨idã€‚</li><li>ç¬¬42è¡Œï¼šâ€ƒ&quot;agentid&quot;:&quot;100035&quot;, #ä¼ä¸šå·ä¸­çš„åº”ç”¨idã€‚</li><li>ç¬¬61è¡Œï¼šâ€ƒcorpid = &#39;22jsaooasbf23934&#39; #CorpIDæ˜¯ä¼ä¸šå·çš„æ ‡è¯†</li><li>ç¬¬62è¡Œï¼šâ€ƒcorpsecret = &#39;410Jsk8_4lvCQYmdo92-sdfafsadfasdfxzc&#39; #corpsecretSecretæ˜¯ç®¡ç†ç»„å‡­è¯å¯†é’¥</li></ul></blockquote><p>ä¼ä¸šéƒ¨é—¨çš„id</p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016347.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ä¼ä¸šå·ä¸­çš„åº”ç”¨id</p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016113.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>CorpIDæ˜¯ä¼ä¸šå·çš„æ ‡è¯†ï¼ˆä¼ä¸šçš„idï¼‰</p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016951.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>ç®¡ç†ç»„å‡­è¯å¯†é’¥ï¼ˆåº”ç”¨çš„Secretï¼Œåœ¨åº”ç”¨ç®¡ç†ä¸­ï¼‰</p><blockquote><p>é‡åˆ°è¿‡æœŸçš„è¯é‡æ–°å‘é€ä¸€ä¸‹å°±å¯ä»¥ï¼›</p></blockquote><p><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016745.png" alt="" loading="lazy"><br><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015758.png" alt="" loading="lazy"></p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015273.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æ›´æ¢å¥½ä¹‹åï¼Œä¿å­˜é€€å‡ºå³å¯ï¼›</p><h3 id="_4ã€æµ‹è¯•è„šæœ¬æ˜¯å¦å¯ç”¨" tabindex="-1"><a class="header-anchor" href="#_4ã€æµ‹è¯•è„šæœ¬æ˜¯å¦å¯ç”¨" aria-hidden="true">#</a> 4ã€æµ‹è¯•è„šæœ¬æ˜¯å¦å¯ç”¨</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>python /usr/lib/zabbix/alertscripts/weixin.py aaabbbccc abc <span class="token number">1234</span>

<span class="token punctuation">{</span>u<span class="token string">&#39;msgid&#39;</span><span class="token builtin class-name">:</span> u<span class="token string">&#39;mrVtVXE39it1tWVvd57npP-C0Y8uy8F_-hstvi9e_Y0gSghmqd6IOO4SWKCTeFNyUYjV8TgdE3IXSGC3g2w_oQ&#39;</span>, u<span class="token string">&#39;errcode&#39;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>, u<span class="token string">&#39;errmsg&#39;</span><span class="token builtin class-name">:</span> u<span class="token string">&#39;ok&#39;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ä¸‰ã€é…ç½®zabbix-webç«¯" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€é…ç½®zabbix-webç«¯" aria-hidden="true">#</a> ä¸‰ã€é…ç½®zabbix webç«¯</h2><br><blockquote><p>å› ä¸ºä¹‹å‰æˆ‘å·²ç»æŠŠç›‘æ§é¡¹å’Œè§¦å‘å™¨å¼„å¥½äº†ï¼Œæ‰€ä»¥ï¼Œç›´æ¥é…ç½®æŠ¥è­¦åª’ä»‹ç±»å‹å°±å¥½äº†ã€‚</p></blockquote>`,22),Y={href:"https://liucy.blog.csdn.net/article/details/124101253",target:"_blank",rel:"noopener noreferrer"},F=o('<h3 id="_1ã€é…ç½®æŠ¥è­¦åª’ä»‹ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_1ã€é…ç½®æŠ¥è­¦åª’ä»‹ç±»å‹" aria-hidden="true">#</a> 1ã€é…ç½®æŠ¥è­¦åª’ä»‹ç±»å‹</h3><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015834.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>è„šæœ¬åç§°ä¸€å®šè¦å’Œalertscriptsç›®å½•ä¸‹æ”¾çš„ä¸€æ ·ï¼›</p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015334.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>å®Œæˆä¹‹åå¤–é¢æœ‰ä¸€ä¸ªæµ‹è¯•ï¼ˆzabbix5.0ä»¥åŠä»¥åæ‰æœ‰ï¼‰</p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015046.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æ”¶ä»¶äººâ€œ@allâ€å°±å¯ä»¥</p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015853.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>å¦‚æœæœ‰æŠ¥é”™ï¼Œå°±è§£å†³ä¸€ä¸‹æŠ¥é”™ï¼›æ²¡æœ‰çš„è¯å°±ç›´æ¥å»ä¼ä¸šå¾®ä¿¡çœ‹çœ‹èƒ½æ”¶åˆ°ä¿¡æ¯å˜›<br> ï¼›<br><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015688.png" alt="" loading="lazy"></p><p>è¿™æ ·å°±æ˜¯å‘é€æˆåŠŸäº†ï¼Œæˆ‘ä»¬å»ä¼ä¸šå¾®ä¿¡çœ‹ä¸€ä¸‹ï¼›</p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015420.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>å¯ä»¥çœ‹åˆ°æ¶ˆæ¯å·²ç»å‘é€è¿‡æ¥äº†ã€‚</p><p>ä½¿æ‰€æœ‰çš„å‘Šè­¦ä¿¡æ¯éƒ½å‘é€åˆ°ä¼ä¸šå¾®ä¿¡çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å¾€ä¸‹çœ‹ï¼›</p><h3 id="_2ã€é…ç½®åŠ¨ä½œ" tabindex="-1"><a class="header-anchor" href="#_2ã€é…ç½®åŠ¨ä½œ" aria-hidden="true">#</a> 2ã€é…ç½®åŠ¨ä½œ</h3><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015344.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>åç§°è‡ªå·±èµ·ä¸€ä¸ªå°±å¥½äº†ï¼›</p><p><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015069.png" alt="" loading="lazy"><br><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015809.png" alt="" loading="lazy"></p><p>ä»…é€åˆ°é€‰æ‹©æ‰€æœ‰å°±å¯ä»¥ï¼š</p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015030.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æ¢å¤æ“ä½œé€‰æ‹©â€œé€šçŸ¥æ‰€æœ‰å‚ä¸è€…â€å°±å¯ä»¥ï¼›</p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015255.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>åŠ¨ä½œè®¾ç½®å®Œæˆï¼Œå»è®¾ç½®ç”¨æˆ·ï¼›</p><h3 id="_3ã€é…ç½®ç”¨æˆ·" tabindex="-1"><a class="header-anchor" href="#_3ã€é…ç½®ç”¨æˆ·" aria-hidden="true">#</a> 3ã€é…ç½®ç”¨æˆ·</h3><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015262.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>é€‰æ‹©æŠ¥è­¦åª’ä»‹---&gt;ç‚¹å‡»æ·»åŠ </p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015382.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>é€‰æ‹©weixinå³å¯ï¼›æ”¶ä»¶äººè¿˜æ˜¯â€œ@allâ€ï¼›</p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015187.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æ·»åŠ å®Œæˆä¹‹åä¸€å®šè¦ç‚¹å‡»æ›´æ–°ï¼›</p><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015890.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_4ã€æµ‹è¯•å‘é€å‘Šè­¦" tabindex="-1"><a class="header-anchor" href="#_4ã€æµ‹è¯•å‘é€å‘Šè­¦" aria-hidden="true">#</a> 4ã€æµ‹è¯•å‘é€å‘Šè­¦</h3><p>æˆåŠŸæ¥æ”¶åˆ°å‘Šè­¦ï¼›<br><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015736.png" alt="" loading="lazy"><br> è‡³æ­¤zabbix5.0é…ç½®ä¼ä¸šå¾®ä¿¡å‘Šè­¦å°±å®Œæˆäº†ã€‚</p>',32);function B(P,Q){const e=p("font"),t=p("ExternalLinkIcon");return c(),u("div",null,[d,g,b,a(e,{color:"green",size:"5"},{default:i(()=>[s("ç›¸å…³æ–‡ç« ï¼š")]),_:1}),n("blockquote",null,[n("p",null,[s("ğŸ’» zabbixçš„å®‰è£…éƒ¨ç½²å¯å‚è€ƒï¼š"),n("a",k,[s("zabbix5.0éƒ¨ç½²ï¼ˆè¶…çº§è¯¦ç»†ï¼‰"),a(t)]),m]),h,n("p",null,[s("ğŸ’» zabbixçš„è„šæœ¬å®‰è£…éƒ¨ç½²å¯å‚è€ƒï¼š"),n("a",v,[s("zabbix5.0ç¦»çº¿è„šæœ¬ä¸€é”®å®‰è£…(åŒ…å«æœåŠ¡ç«¯ã€å®¢æˆ·ç«¯ã€è„šæœ¬å’Œä½¿ç”¨è¯´æ˜)"),a(t)]),y]),f,_]),x,z,n("p",null,[n("strong",null,[a(e,{color:"red"},{default:i(()=>[s("â€ƒâ€ƒå¦‚æœéœ€è¦ç”¨å…¬å¸çš„ä¼ä¸šå¾®ä¿¡æ¥åšå‘Šè­¦ä¿¡æ¯çš„æ¥æ”¶è€…ï¼Œé‚£ä¹ˆè¿™ä¸ªæ­¥éª¤å°±å¯ä»¥çœç•¥äº†ã€‚")]),_:1})])]),q,n("p",null,[s("æ²¡æœ‰ä¼ä¸šå¾®ä¿¡æˆ‘ä»¬å¯ä»¥åˆ°è¿™é‡Œæ³¨å†Œä¸€ä¸ªï¼š"),n("a",j,[s("https://work.weixin.qq.com/"),a(t)])]),w,I,C,S,V,n("p",null,[s("æ³¨å†Œå®Œæˆä¹‹åä¹Ÿå¯ä»¥é‚€è¯·åŒäº‹æˆ–è€…åŒå­¦ã€æœ‹å‹è¿›æ¥éƒ½å¯ä»¥ï¼›"),D,s(" æ³¨å†Œå®Œæˆåé€šè¿‡ç½‘é¡µç™»é™†ä¼ä¸šå¾®ä¿¡ï¼ˆ"),n("strong",null,[a(e,{color:"red"},{default:i(()=>[s("å› ä¸ºä¸€äº›æ“ä½œåªæœ‰é¡µé¢ç®¡ç†èƒ½æ“ä½œ")]),_:1})]),s("ï¼‰")]),E,n("blockquote",null,[n("p",null,[s("ä¸‹è½½åœ°å€ï¼š"),n("a",N,[s("zabbixå¾®ä¿¡å‘Šè­¦.py"),a(t)])])]),T,n("p",null,[s("å¯ä»¥å‚è€ƒï¼š"),n("a",Y,[s("zabbixæ·»åŠ è‡ªå®šä¹‰ç›‘æ§é¡¹&å‘Šè­¦ï¼ˆé‚®ä»¶ï¼‰"),a(t)])]),F])}const O=l(r,[["render",B],["__file","Zabbix5.0é…ç½®ä¼ä¸šå¾®ä¿¡å‘Šè­¦.html.vue"]]);export{O as default};
