<template><div><blockquote>
<p>ğŸ‘¨â€ğŸ“<strong>åšä¸»ç®€ä»‹</strong></p>
<p>â€ƒâ€ƒğŸ…<a href="https://blog.csdn.net/liu_chen_yang?type=blog" target="_blank" rel="noopener noreferrer">äº‘è®¡ç®—é¢†åŸŸä¼˜è´¨åˆ›ä½œè€…<ExternalLinkIcon/></a><br>
â€ƒâ€ƒğŸ…<a href="https://bbs.huaweicloud.com/community/myblog" target="_blank" rel="noopener noreferrer">åä¸ºäº‘å¼€å‘è€…ç¤¾åŒºä¸“å®¶åšä¸»<ExternalLinkIcon/></a><br>
â€ƒâ€ƒğŸ…<a href="https://developer.aliyun.com/my?spm=a2c6h.13148508.setting.3.21fc4f0eCmz1v3#/article?_k=zooqoz" target="_blank" rel="noopener noreferrer">é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒºä¸“å®¶åšä¸»<ExternalLinkIcon/></a><br>
ğŸ’Š<strong>äº¤æµç¤¾åŒºï¼š</strong><a href="https://bbs.csdn.net/forums/lcy" target="_blank" rel="noopener noreferrer">è¿ç»´äº¤æµç¤¾åŒº<ExternalLinkIcon/></a> æ¬¢è¿å¤§å®¶çš„åŠ å…¥ï¼<br>
ğŸ‹ å¸Œæœ›å¤§å®¶å¤šå¤šæ”¯æŒï¼Œæˆ‘ä»¬ä¸€èµ·è¿›æ­¥ï¼ğŸ˜„<br>
ğŸ‰å¦‚æœæ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œæ¬¢è¿ ç‚¹èµ ğŸ‘ğŸ» è¯„è®º ğŸ’¬ æ”¶è— â­ï¸ åŠ å…³æ³¨+ğŸ’—</p>
</blockquote>
<h1 id="ansible-ä¸­çš„-ad-hoc-æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#ansible-ä¸­çš„-ad-hoc-æ¨¡å¼" aria-hidden="true">#</a> Ansible ä¸­çš„ ad-hoc æ¨¡å¼</h1>
<p>Ad-hocæ¨¡å¼çš„ä½¿ç”¨åœºæ™¯:</p>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-0" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-0"> æŸ¥çœ‹æŸä¸ªè¿›ç¨‹çš„ä¿¡æ¯</label></li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-1" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-1"> æ‹·è´æ—¥å¿—åˆ°æœ¬åœ°</label></li>
</ul>
<p>Ad-hocæ¨¡å¼çš„å‘½ä»¤æ ¼å¼ ï¼š</p>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible ä¸»æœºç»„åç§° <span class="token parameter variable">-m</span> æ¨¡å— <span class="token parameter variable">-a</span> â€œå…·ä½“å‘½ä»¤â€

å¸¸ç”¨é€‰é¡¹:
<span class="token parameter variable">-m</span> æŒ‡å®šè¦ä½¿ç”¨çš„æ¨¡å—ï¼Œä¸æŒ‡å®šé»˜è®¤ä½¿ç”¨commandæ¨¡å— 
<span class="token parameter variable">-a</span> æŒ‡å®šè¦æ‰§è¡Œçš„å…·ä½“å‘½ä»¤
<span class="token parameter variable">-i</span>  æŒ‡å®šè‡ªå®šä¹‰çš„ä¸»æœºæ¸…å•é…ç½®æ–‡ä»¶ 
<span class="token parameter variable">-f</span>  ä¸€æ¬¡è¿”å›å‡ ä¸ªç»“æœ
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_1ã€ansibleå¸®åŠ©å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#_1ã€ansibleå¸®åŠ©å‘½ä»¤" aria-hidden="true">#</a> 1ã€Ansibleå¸®åŠ©å‘½ä»¤</h2>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible-doc 		<span class="token comment">#å¸®åŠ©å‘½ä»¤ </span>
ansible-doc <span class="token parameter variable">-l</span>   	<span class="token comment">#åˆ—å‡ºæ‰€ä»¥çš„æ¨¡å—</span>
ansible-doc æ¨¡å—å   <span class="token comment">#æŸ¥çœ‹æ¨¡å—çš„è¯¦ç»†ä¿¡æ¯</span>
ansible-doc æ¨¡å—å <span class="token parameter variable">-s</span>  <span class="token comment">#æŸ¥çœ‹æ¨¡å—çš„é€‰é¡¹ä½¿ç”¨è¯´æ˜</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2ã€ad-hoc-æ¨¡å¼æ‰§è¡Œæµç¨‹" tabindex="-1"><a class="header-anchor" href="#_2ã€ad-hoc-æ¨¡å¼æ‰§è¡Œæµç¨‹" aria-hidden="true">#</a> 2ã€ad-hoc æ¨¡å¼æ‰§è¡Œæµç¨‹</h2>
<p>æ¨¡å—æ‰§è¡Œçš„å·¥ä½œæµç¨‹:</p>
<ul>
<li>
<p>1.ä¸»æ§ç«¯å‘½ä»¤è¡Œæ‰§è¡Œå‘½ä»¤ï¼›</p>
</li>
<li>
<p>2.å°†æ¨¡å—æ‹·è´åˆ°å—æ§ç«¯ï¼›</p>
</li>
<li>
<p>3.æŒ‰ç…§æ¨¡å—å®šä¹‰çš„æ“ä½œåœ¨å—æ§ç«¯æ‰§è¡Œï¼›</p>
</li>
<li>
<p>4.è¿”å›ä¿¡æ¯ï¼Œåˆ é™¤å—æ§ç«¯æ¨¡å—ï¼›</p>
</li>
</ul>
<blockquote>
<p>è¯´æ˜ï¼š</p>
<p>ansibleæ¨¡å—å¯ä»¥ä½¿ç”¨çš„å‰ææ˜¯ï¼šä¸»æ§ç«¯ä¸å—æ§ç«¯pythonç‰ˆæœ¬ä¸€è‡´ï¼Œå¹¶ä¸”Ansibleçš„æ¨¡å—æ˜¯å¹‚ç­‰æ‰§è¡Œçš„</p>
</blockquote>
<p>Ansibleæ‰§è¡Œå‘½ä»¤çš„è¿”å›å€¼é¢œè‰²:</p>
<blockquote>
<font color=feces yellow>å±é»„è‰²:æ‰§è¡Œå‘½ä»¤æˆåŠŸï¼Œå¹¶ä¸”åšäº†ä¿®æ”¹ï¼›</font><font color=mediumseagreen>è‰å¸½ç»¿:æ‰§è¡Œå‘½ä»¤æˆåŠŸï¼ŒåªæŸ¥çœ‹ä¿¡æ¯ï¼Œæ²¡æœ‰ä¿®æ”¹</font><font color=deeppink>ç«ç‘°çº¢:æ‰§è¡Œå¤±è´¥ï¼ŒæŠ¥é”™ </font><font color=rebeccapurple>è‘¡è„ç´«:è¡¨ç¤ºå¯¹å‘½ä»¤å‘é”™çš„æ“ä½œæœ‰è­¦å‘Šä¿¡æ¯</font></blockquote>
<p>æ¯”å¦‚ä¸Šé¢ï¼Œæœ€å¼€å§‹çš„ä¸»æœºæ¸…å•é…ç½®è§„åˆ™ä¸­ï¼Œè¿”å›çš„ç»“æœå°±æ˜¯ç»¿è‰²çš„ï¼Œè¡¨ç¤ºåªæŸ¥çœ‹ï¼Œå¹¶ä¸ä¼šåšä¿®æ”¹ã€‚</p>
<h2 id="_3ã€ansibleä¸­å¸¸è§çš„è¿”å›å€¼" tabindex="-1"><a class="header-anchor" href="#_3ã€ansibleä¸­å¸¸è§çš„è¿”å›å€¼" aria-hidden="true">#</a> 3ã€Ansibleä¸­å¸¸è§çš„è¿”å›å€¼</h2>
<table>
<thead>
<tr>
<th>è¿”å›å€¼</th>
<th>è¿”å›å€¼å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>changed</td>
<td>å‡ ä¹æ‰€æœ‰çš„Ansibleæ¨¡å—éƒ½ä¼šè¿”å›è¯¥å˜é‡ï¼Œè¡¨ç¤ºæ¨¡å—æ˜¯å¦å¯¹è¿œç¨‹ä¸»æœºæ‰§è¡Œäº†ä¿®æ”¹æ“ä½œ</td>
</tr>
<tr>
<td>failed</td>
<td>å¦‚æœæ¨¡å—æœªèƒ½æ‰§è¡Œå®Œæˆï¼Œå°†è¿”å›failedä¸ºtrue</td>
</tr>
<tr>
<td>msg</td>
<td>æ¨¡å—æ‰§è¡Œå¤±è´¥çš„åŸå› ï¼Œå¸¸è§çš„é”™è¯¯å¦‚sshè¿æ¥å¤±è´¥</td>
</tr>
<tr>
<td>rc</td>
<td>ä¸å‘½ä»¤è¡Œå·¥å…·ç›¸å…³çš„æ¨¡å—ä¼šè¿”å›rc,è¡¨ç¤ºæ‰§è¡ŒLinuxå‘½ä»¤çš„çŠ¶æ€ç </td>
</tr>
<tr>
<td>stdout</td>
<td>ä¸rcç±»ä¼¼ï¼Œè¿”å›çš„æ˜¯æ ‡å‡†è¾“å‡ºçš„ç»“æœ</td>
</tr>
<tr>
<td>stderr</td>
<td>ä¸rcç±»ä¼¼ï¼Œè¿”å›çš„æ˜¯æ ‡å‡†é”™è¯¯çš„ç»“æœ</td>
</tr>
<tr>
<td>backup_file</td>
<td>æ‰€æœ‰å­˜åœ¨backupé€‰é¡¹çš„æ¨¡å—ï¼Œç”¨æ¥è¿”å›å¤‡ä»½æ–‡ä»¶çš„è·¯å¾„</td>
</tr>
<tr>
<td>results</td>
<td>åº”ç”¨åœ¨playbookä¸­å­˜åœ¨å¾ªç¯çš„æƒ…å†µï¼Œè¿”å›å¤šä¸ªç»“æœ</td>
</tr>
</tbody>
</table>
<h2 id="_4ã€å¸¸ç”¨æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_4ã€å¸¸ç”¨æ¨¡å—" aria-hidden="true">#</a> 4ã€å¸¸ç”¨æ¨¡å—</h2>
<ul>
<li>è¿œç¨‹å‘½ä»¤ç›¸å…³</li>
</ul>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code><span class="token number">1</span>. <span class="token builtin class-name">command</span>  	<span class="token comment"># é»˜è®¤ä½¿ç”¨æ¨¡å—ï¼Œç”¨äºè¿œç¨‹æ‰§å‘½ä»¤ï¼Œä¸æ”¯æŒç®¡é“</span>
<span class="token number">2</span>. shell   		<span class="token comment"># è¿œç¨‹æ‰§è¡Œå‘½ä»¤ï¼Œæ”¯æŒç®¡é“ </span>
<span class="token number">3</span>. raw    		<span class="token comment"># sshç™»å½•ï¼Œå†æ‰§è¡Œ</span>
<span class="token number">4</span>. script   	<span class="token comment"># è¿œç¨‹æ‰§è¡Œæœ¬åœ°è„šæœ¬</span>
<span class="token number">5</span>. yum			<span class="token comment"># è¿œç¨‹å®‰è£…</span>
<span class="token number">6</span>. copy			<span class="token comment"># æ¨é€æ–‡ä»¶</span>
<span class="token number">7</span>. <span class="token function">file</span>			<span class="token comment"># å¯¹æ–‡ä»¶æ“ä½œ</span>
<span class="token number">8</span>. <span class="token function">service</span>		<span class="token comment"># æ§åˆ¶å¯åŠ¨å…³é—­æœåŠ¡</span>
<span class="token number">9</span>. systemd   	<span class="token comment"># æ§åˆ¶å¯åŠ¨å…³é—­æœåŠ¡</span>
<span class="token number">10</span>. <span class="token function">cron</span>		<span class="token comment"># å®šæ—¶ä»»åŠ¡æ¨¡å—</span>
<span class="token number">11</span>. <span class="token function">mount</span>		<span class="token comment"># æŒ‚è½½ä¸å¸è½½æ¨¡å—</span>
<span class="token number">12</span>. user/group	<span class="token comment"># ç”¨äºç®¡ç†çš„ç”¨æˆ·åˆ›å»ºä¸åˆ é™¤</span>
<span class="token number">13</span>. unarchive	<span class="token comment"># è§£å‹ç¼©æ¨¡å—</span>
<span class="token number">14</span>. get_url		<span class="token comment"># ä¸‹è½½æ–‡ä»¶ï¼Œç±»ä¼¼äºcurl</span>
<span class="token number">15</span>. firewalld	<span class="token comment"># é˜²ç«å¢™</span>
<span class="token number">16</span>. selinux		<span class="token comment"># selinux</span>
<span class="token number">17</span>. setup		<span class="token comment"># è·å–ä¸»æœºä¿¡æ¯</span>
<span class="token number">18</span>. <span class="token function">git</span>			<span class="token comment"># gitå‘½ä»¤æ¨¡å—</span>
<span class="token number">19</span>. <span class="token function">sysctl</span>      <span class="token comment"># æ§åˆ¶å†…æ ¸</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5ã€å¸¸ç”¨æ¨¡å—çš„ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#_5ã€å¸¸ç”¨æ¨¡å—çš„ç”¨æ³•" aria-hidden="true">#</a> 5ã€å¸¸ç”¨æ¨¡å—çš„ç”¨æ³•</h2>
<h3 id="_5-1-command-æ¨¡å—-ç”¨äºè¿œç¨‹æ‰§å‘½ä»¤-ä¸æ”¯æŒç®¡é“" tabindex="-1"><a class="header-anchor" href="#_5-1-command-æ¨¡å—-ç”¨äºè¿œç¨‹æ‰§å‘½ä»¤-ä¸æ”¯æŒç®¡é“" aria-hidden="true">#</a> 5.1 command  æ¨¡å—ï¼šç”¨äºè¿œç¨‹æ‰§å‘½ä»¤ï¼Œä¸æ”¯æŒç®¡é“</h3>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-2" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-2"> command  æ¨¡å—ï¼šç”¨äºè¿œç¨‹æ‰§å‘½ä»¤ï¼Œä¸æ”¯æŒç®¡é“</label></li>
</ul>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible ä¸»æœºç»„åç§° <span class="token parameter variable">-m</span> <span class="token builtin class-name">command</span> <span class="token parameter variable">-a</span> â€œå…·ä½“å‘½ä»¤â€
ansible ä¸»æœºç»„åç§° <span class="token parameter variable">-a</span> â€œå…·ä½“å‘½ä»¤â€
<span class="token comment"># é»˜è®¤ä¸ºcommandæ¨¡å—</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># vim /etc/ansible/hosts </span>
<span class="token comment">#é…ç½®è¦è¿œç¨‹çš„åœ°å€</span>
<span class="token punctuation">[</span>web_group<span class="token punctuation">]</span>
<span class="token number">172.16</span>.11.209
<span class="token number">172.16</span>.10.232

<span class="token punctuation">[</span>web_group:vars<span class="token punctuation">]</span>
<span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123123'</span>

<span class="token comment">#æ‰§è¡Œï¼š</span>
<span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># ansible web_group -a "mkdir /root/cs123"</span>
<span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span>: Consider using the <span class="token function">file</span> module with <span class="token assign-left variable">state</span><span class="token operator">=</span>directory rather than running <span class="token string">'mkdir'</span><span class="token builtin class-name">.</span>  If you need to use <span class="token builtin class-name">command</span> because <span class="token function">file</span> is insufficient you can
<span class="token function">add</span> <span class="token string">'warn: false'</span> to this <span class="token builtin class-name">command</span> task or <span class="token builtin class-name">set</span> <span class="token string">'command_warnings=False'</span> <span class="token keyword">in</span> ansible.cfg to get rid of this message.
<span class="token number">172.16</span>.11.209 <span class="token operator">|</span> CHANGED <span class="token operator">|</span> <span class="token assign-left variable">rc</span><span class="token operator">=</span><span class="token number">0</span> <span class="token operator">>></span>

<span class="token number">172.16</span>.10.232 <span class="token operator">|</span> CHANGED <span class="token operator">|</span> <span class="token assign-left variable">rc</span><span class="token operator">=</span><span class="token number">0</span> <span class="token operator">>></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>
<h3 id="_5-2-shell-æ¨¡å—-è¿œç¨‹æ‰§è¡Œå‘½ä»¤-æ”¯æŒç®¡é“" tabindex="-1"><a class="header-anchor" href="#_5-2-shell-æ¨¡å—-è¿œç¨‹æ‰§è¡Œå‘½ä»¤-æ”¯æŒç®¡é“" aria-hidden="true">#</a> 5.2 shell æ¨¡å—ï¼šè¿œç¨‹æ‰§è¡Œå‘½ä»¤ï¼Œæ”¯æŒç®¡é“</h3>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-3" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-3"> shell æ¨¡å—ï¼šè¿œç¨‹æ‰§è¡Œå‘½ä»¤ï¼Œæ”¯æŒç®¡é“</label></li>
</ul>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible ä¸»æœºç»„åç§° <span class="token parameter variable">-m</span> shell <span class="token parameter variable">-a</span> â€œå…·ä½“å‘½ä»¤â€
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># vim /etc/ansible/hosts </span>
<span class="token comment">#é…ç½®è¦è¿œç¨‹çš„åœ°å€</span>
<span class="token punctuation">[</span>web_group<span class="token punctuation">]</span>
<span class="token number">172.16</span>.11.209
<span class="token number">172.16</span>.10.232

<span class="token punctuation">[</span>web_group:vars<span class="token punctuation">]</span>
<span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123123'</span>

<span class="token comment">#æ‰§è¡Œï¼š</span>
<span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># ansible web_group -m shell -a "ls /home/test/"</span>
<span class="token number">172.16</span>.10.232 <span class="token operator">|</span> CHANGED <span class="token operator">|</span> <span class="token assign-left variable">rc</span><span class="token operator">=</span><span class="token number">0</span> <span class="token operator">>></span>
xunjian-yong.sh

<span class="token comment"># åœ¨æ‰§è¡Œçš„æ—¶å€™å¤šä¸ªåœ°å€æ˜¯ä¸åˆ†å¼€çš„ï¼Œéœ€è¦ä»”ç»†è§‚çœ‹</span>

<span class="token number">172.16</span>.11.209 <span class="token operator">|</span> CHANGED <span class="token operator">|</span> <span class="token assign-left variable">rc</span><span class="token operator">=</span><span class="token number">0</span> <span class="token operator">>></span>
xunjian-yong.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>
<h3 id="_5-3-raw-æ¨¡å—-sshç™»å½•-å†æ‰§è¡Œ" tabindex="-1"><a class="header-anchor" href="#_5-3-raw-æ¨¡å—-sshç™»å½•-å†æ‰§è¡Œ" aria-hidden="true">#</a> 5.3 raw æ¨¡å—ï¼šsshç™»å½•ï¼Œå†æ‰§è¡Œ</h3>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-4" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-4"> raw æ¨¡å—ï¼šsshç™»å½•ï¼Œå†æ‰§è¡Œ</label></li>
</ul>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible ä¸»æœºç»„åç§° <span class="token parameter variable">-m</span> raw <span class="token parameter variable">-a</span> â€œå…·ä½“å‘½ä»¤â€
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># vim /etc/ansible/hosts </span>
<span class="token comment">#é…ç½®è¦è¿œç¨‹çš„åœ°å€</span>
<span class="token punctuation">[</span>web_group<span class="token punctuation">]</span>
<span class="token number">172.16</span>.11.209
<span class="token number">172.16</span>.10.232

<span class="token punctuation">[</span>web_group:vars<span class="token punctuation">]</span>
<span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123123'</span>

<span class="token comment">#æ‰§è¡Œï¼š</span>
<span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># ansible web_group -m raw -a "ls /home/test/"</span>
<span class="token number">172.16</span>.10.232 <span class="token operator">|</span> CHANGED <span class="token operator">|</span> <span class="token assign-left variable">rc</span><span class="token operator">=</span><span class="token number">0</span> <span class="token operator">>></span>
xunjian-yong.sh
Shared connection to <span class="token number">172.16</span>.10.232 closed.

<span class="token number">172.16</span>.11.209 <span class="token operator">|</span> CHANGED <span class="token operator">|</span> <span class="token assign-left variable">rc</span><span class="token operator">=</span><span class="token number">0</span> <span class="token operator">>></span>
xunjian-yong.sh
Shared connection to <span class="token number">172.16</span>.11.209 closed.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>
<h3 id="_5-4-script-æ¨¡å—-è¿œç¨‹æ‰§è¡Œæœ¬åœ°è„šæœ¬" tabindex="-1"><a class="header-anchor" href="#_5-4-script-æ¨¡å—-è¿œç¨‹æ‰§è¡Œæœ¬åœ°è„šæœ¬" aria-hidden="true">#</a> 5.4 script æ¨¡å—ï¼šè¿œç¨‹æ‰§è¡Œæœ¬åœ°è„šæœ¬</h3>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-5" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-5"> script æ¨¡å—ï¼šè¿œç¨‹æ‰§è¡Œæœ¬åœ°è„šæœ¬</label></li>
</ul>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible ä¸»æœºç»„åç§° <span class="token parameter variable">-m</span> script <span class="token parameter variable">-a</span> <span class="token string">"your_script_file"</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªå‘½ä»¤ä¸­ï¼Œå°†<code v-pre>ä¸»æœºç»„åç§°</code>æ›¿æ¢ä¸ºæ‚¨çš„ç›®æ ‡ä¸»æœºåæˆ–ç»„åï¼Œå¹¶å°†<code v-pre>your_script_file</code>æ›¿æ¢ä¸ºæ‚¨è¦åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œçš„è„šæœ¬æ–‡ä»¶çš„æœ¬åœ°è·¯å¾„ã€‚</p>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># vim /etc/ansible/hosts </span>
<span class="token comment">#é…ç½®è¦è¿œç¨‹çš„åœ°å€</span>
<span class="token punctuation">[</span>web_group<span class="token punctuation">]</span>
<span class="token number">172.16</span>.11.209
<span class="token number">172.16</span>.10.232

<span class="token punctuation">[</span>web_group:vars<span class="token punctuation">]</span>
<span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123123'</span>

<span class="token comment">#æ‰§è¡Œï¼š</span>
<span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># ansible web_group -m script -a "/home/test/a.sh"</span>
<span class="token number">172.16</span>.11.209 <span class="token operator">|</span> CHANGED <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token string">"changed"</span><span class="token builtin class-name">:</span> true, 
    <span class="token string">"rc"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>, 
    <span class="token string">"stderr"</span><span class="token builtin class-name">:</span> <span class="token string">"Shared connection to 172.16.11.209 closed.<span class="token entity" title="\r">\r</span><span class="token entity" title="\n">\n</span>"</span>, 
    <span class="token string">"stderr_lines"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token string">"Shared connection to 172.16.11.209 closed."</span>
    <span class="token punctuation">]</span>, 
    <span class="token string">"stdout"</span><span class="token builtin class-name">:</span> <span class="token string">"bin  games    lib    libexec<span class="token entity" title="\t">\t</span>    openssh-9.4p1.tar.gz  openssl-1.1.1t  share<span class="token entity" title="\r">\r</span><span class="token entity" title="\n">\n</span>etc  include  lib64  openssh-9.4p1  openssl<span class="token entity" title="\t">\t</span><span class="token entity" title="\t">\t</span>  sbin<span class="token entity" title="\t">\t</span><span class="token entity" title="\t">\t</span>  src<span class="token entity" title="\r">\r</span><span class="token entity" title="\n">\n</span>"</span>, 
    <span class="token string">"stdout_lines"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token string">"bin  games    lib    libexec<span class="token entity" title="\t">\t</span>    openssh-9.4p1.tar.gz  openssl-1.1.1t  share"</span>, 
        <span class="token string">"etc  include  lib64  openssh-9.4p1  openssl<span class="token entity" title="\t">\t</span><span class="token entity" title="\t">\t</span>  sbin<span class="token entity" title="\t">\t</span><span class="token entity" title="\t">\t</span>  src"</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token number">172.16</span>.10.232 <span class="token operator">|</span> CHANGED <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token string">"changed"</span><span class="token builtin class-name">:</span> true, 
    <span class="token string">"rc"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>, 
    <span class="token string">"stderr"</span><span class="token builtin class-name">:</span> <span class="token string">"Shared connection to 172.16.10.232 closed.<span class="token entity" title="\r">\r</span><span class="token entity" title="\n">\n</span>"</span>, 
    <span class="token string">"stderr_lines"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token string">"Shared connection to 172.16.10.232 closed."</span>
    <span class="token punctuation">]</span>, 
    <span class="token string">"stdout"</span><span class="token builtin class-name">:</span> <span class="token string">"bin  games    lib    libexec<span class="token entity" title="\t">\t</span>    openssl<span class="token entity" title="\t">\t</span>    phpstudy  share<span class="token entity" title="\r">\r</span><span class="token entity" title="\n">\n</span>etc  include  lib64  openssh-9.3p2  openssl-1.1.1t  sbin      src<span class="token entity" title="\r">\r</span><span class="token entity" title="\n">\n</span>"</span>, 
    <span class="token string">"stdout_lines"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token string">"bin  games    lib    libexec<span class="token entity" title="\t">\t</span>    openssl<span class="token entity" title="\t">\t</span>    phpstudy  share"</span>, 
        <span class="token string">"etc  include  lib64  openssh-9.3p2  openssl-1.1.1t  sbin      src"</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>a.shä¸­å†…å®¹ä¸ºï¼š<code v-pre>ls /usr/local/</code></p>
<p>è¿™å°†åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œ<code v-pre>a.sh</code>è„šæœ¬æ–‡ä»¶ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œ<code v-pre>script</code>æ¨¡å—ä¼šå°†è„šæœ¬æ–‡ä»¶ä¼ è¾“åˆ°ç›®æ ‡ä¸»æœºï¼Œç„¶ååœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œå®ƒã€‚å› æ­¤ï¼Œç¡®ä¿è„šæœ¬æ–‡ä»¶åœ¨æ§åˆ¶èŠ‚ç‚¹ä¸Šå¯ç”¨ï¼Œå¹¶ä¸”å…·æœ‰å¯æ‰§è¡Œæƒé™ï¼ˆä½¿ç”¨<code v-pre>chmod +x</code>å‘½ä»¤æ·»åŠ æ‰§è¡Œæƒé™ï¼‰ã€‚</p>
<p>ä¸<code v-pre>raw</code>æ¨¡å—ä¸åŒï¼Œ<code v-pre>script</code>æ¨¡å—å…è®¸æ‚¨åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œæœ¬åœ°è„šæœ¬æ–‡ä»¶ï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨ä¼ è¾“è„šæœ¬å†…å®¹ã€‚è¿™å¯¹äºæ‰§è¡Œå¤æ‚çš„æœ¬åœ°æ“ä½œéå¸¸æœ‰ç”¨ã€‚</p>
<hr>
<h3 id="_5-5-yum-æ¨¡å—-è¿œç¨‹å®‰è£…è½¯ä»¶" tabindex="-1"><a class="header-anchor" href="#_5-5-yum-æ¨¡å—-è¿œç¨‹å®‰è£…è½¯ä»¶" aria-hidden="true">#</a> 5.5 yum æ¨¡å—ï¼šè¿œç¨‹å®‰è£…è½¯ä»¶</h3>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-6" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-6"> yum æ¨¡å—ï¼šè¿œç¨‹å®‰è£…è½¯ä»¶</label></li>
</ul>
<p><code v-pre>name</code>=è½¯ä»¶åŒ…çš„åï¼Œå¤šä¸ªè½¯ä»¶åŒ…é€—å·éš”å¼€</p>
<p><code v-pre>state</code>=<code v-pre>installed/present</code>å®‰è£…ã€<code v-pre>removed/absent</code>å¸è½½ ã€<code v-pre>lastest</code> æ›´æ–°ã€<code v-pre>installed</code>åˆ—å‡ºå·²å®‰è£…çš„åŒ…</p>
<blockquote>
<p>yumæ¨¡å—çš„æ›´å¤šä½¿ç”¨å¯ä½¿ç”¨<code v-pre>ansible-doc yum</code>æŸ¥çœ‹ã€‚</p>
</blockquote>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible ä¸»æœºç»„åç§° <span class="token parameter variable">-m</span> yum <span class="token parameter variable">-a</span> <span class="token string">"name=è¦å®‰è£…\å¸è½½\æ›´æ–°çš„åŒ…å state=æ˜¯å®‰è£…è¿˜æ˜¯å¸è½½è¿˜æ˜¯æ›´æ–°"</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># vim /etc/ansible/hosts </span>
<span class="token comment">#é…ç½®è¦å®‰è£…çš„åœ°å€</span>
<span class="token punctuation">[</span>web_group<span class="token punctuation">]</span>
<span class="token number">172.16</span>.11.209
<span class="token number">172.16</span>.10.232

<span class="token punctuation">[</span>web_group:vars<span class="token punctuation">]</span>
<span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123123'</span>

<span class="token comment">#æ‰§è¡Œï¼š</span>
<span class="token comment">#æ›´æ–°lrzszå‘½ä»¤</span>
<span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># ansible web_group -m yum -a "name=lrzsz state=latest"</span>
<span class="token comment">#å®‰è£…tldrå’Œnetstatå‘½ä»¤</span>
<span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># ansible web_group -m yum -a "name=tldr,net-tools state=present"</span>
<span class="token number">172.16</span>.10.232 <span class="token operator">|</span> SUCCESS <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token string">"ansible_facts"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">"discovered_interpreter_python"</span><span class="token builtin class-name">:</span> <span class="token string">"/usr/bin/python"</span>
    <span class="token punctuation">}</span>, 
    <span class="token string">"changed"</span><span class="token builtin class-name">:</span> false, 
    <span class="token string">"msg"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>, 
    <span class="token string">"rc"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>, 
    <span class="token string">"results"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token string">"tldr-1.2.0-4.el7.noarch providing tldr is already installed"</span>, 
        <span class="token string">"net-tools-2.0-0.25.20131004git.el7.x86_64 providing net-tools is already installed"</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token number">172.16</span>.11.209 <span class="token operator">|</span> SUCCESS <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token string">"ansible_facts"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">"discovered_interpreter_python"</span><span class="token builtin class-name">:</span> <span class="token string">"/usr/bin/python"</span>
    <span class="token punctuation">}</span>, 
    <span class="token string">"changed"</span><span class="token builtin class-name">:</span> false, 
    <span class="token string">"msg"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>, 
    <span class="token string">"rc"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>, 
    <span class="token string">"results"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token string">"tldr-1.2.0-4.el7.noarch providing tldr is already installed"</span>, 
        <span class="token string">"net-tools-2.0-0.25.20131004git.el7.x86_64 providing net-tools is already installed"</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>
<h3 id="_5-6-copy-æ¨¡å—-æ¨é€æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_5-6-copy-æ¨¡å—-æ¨é€æ–‡ä»¶" aria-hidden="true">#</a> 5.6 copy æ¨¡å—ï¼šæ¨é€æ–‡ä»¶</h3>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-7" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-7"> copy æ¨¡å—ï¼šæ¨é€æ–‡ä»¶</label></li>
</ul>
<p>æ¨é€æ–‡ä»¶æ¨¡å—</p>
<p><code v-pre>src</code>= æºæ–‡ä»¶è·¯å¾„</p>
<p><code v-pre>dest</code>= ç›®æ ‡æ–‡ä»¶è·¯å¾„</p>
<p><code v-pre>content</code>= æŒ‡å®šæ–‡ä»¶å†…å®¹ï¼Œåªæœ‰ç›®æ ‡æ–‡ä»¶ï¼›å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ä¼šåˆ›å»º</p>
<p><code v-pre>owner</code>=  æŒ‡å®šå±ä¸»</p>
<p><code v-pre>group</code>=  æŒ‡å®šå±ç»„</p>
<p><code v-pre>mode</code>=   æŒ‡å®šæƒé™</p>
<p>copy æ¨¡å—çš„æ›´å¤šä½¿ç”¨å¯ä½¿ç”¨<code v-pre>ansible-doc copy</code>æŸ¥çœ‹ã€‚</p>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible ä¸»æœºç»„åç§° <span class="token parameter variable">-m</span> copy <span class="token parameter variable">-a</span> <span class="token string">"src=æ–‡ä»¶è·¯å¾„åŠæ–‡ä»¶ dest=ç›®å½•æ–‡ä»¶è·¯å¾„"</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># vim /etc/ansible/hosts </span>
<span class="token comment">#é…ç½®è¦å¤åˆ¶çš„åœ°å€</span>
<span class="token punctuation">[</span>web_group<span class="token punctuation">]</span>
<span class="token number">172.16</span>.11.209
<span class="token number">172.16</span>.10.232

<span class="token punctuation">[</span>web_group:vars<span class="token punctuation">]</span>
<span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123123'</span>

<span class="token comment">#æ‰§è¡Œï¼š</span>
<span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># ansible web_group -m copy -a "src=/root/tongji.sh dest=/home/test/"</span>
<span class="token number">172.16</span>.10.232 <span class="token operator">|</span> SUCCESS <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token string">"ansible_facts"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">"discovered_interpreter_python"</span><span class="token builtin class-name">:</span> <span class="token string">"/usr/bin/python"</span>
    <span class="token punctuation">}</span>, 
    <span class="token string">"changed"</span><span class="token builtin class-name">:</span> false, 
    <span class="token string">"checksum"</span><span class="token builtin class-name">:</span> <span class="token string">"4eff49d9f511f76b733cf739e820f8b7d17ff3f3"</span>, 
    <span class="token string">"dest"</span><span class="token builtin class-name">:</span> <span class="token string">"/home/test/tongji.sh"</span>, 
    <span class="token string">"gid"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>, 
    <span class="token string">"group"</span><span class="token builtin class-name">:</span> <span class="token string">"root"</span>, 
    <span class="token string">"mode"</span><span class="token builtin class-name">:</span> <span class="token string">"0644"</span>, 
    <span class="token string">"owner"</span><span class="token builtin class-name">:</span> <span class="token string">"root"</span>, 
    <span class="token string">"path"</span><span class="token builtin class-name">:</span> <span class="token string">"/home/test/tongji.sh"</span>, 
    <span class="token string">"size"</span><span class="token builtin class-name">:</span> <span class="token number">10156</span>, 
    <span class="token string">"state"</span><span class="token builtin class-name">:</span> <span class="token string">"file"</span>, 
    <span class="token string">"uid"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token number">172.16</span>.11.209 <span class="token operator">|</span> SUCCESS <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token string">"ansible_facts"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">"discovered_interpreter_python"</span><span class="token builtin class-name">:</span> <span class="token string">"/usr/bin/python"</span>
    <span class="token punctuation">}</span>, 
    <span class="token string">"changed"</span><span class="token builtin class-name">:</span> false, 
    <span class="token string">"checksum"</span><span class="token builtin class-name">:</span> <span class="token string">"4eff49d9f511f76b733cf739e820f8b7d17ff3f3"</span>, 
    <span class="token string">"dest"</span><span class="token builtin class-name">:</span> <span class="token string">"/home/test/tongji.sh"</span>, 
    <span class="token string">"gid"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>, 
    <span class="token string">"group"</span><span class="token builtin class-name">:</span> <span class="token string">"root"</span>, 
    <span class="token string">"mode"</span><span class="token builtin class-name">:</span> <span class="token string">"0644"</span>, 
    <span class="token string">"owner"</span><span class="token builtin class-name">:</span> <span class="token string">"root"</span>, 
    <span class="token string">"path"</span><span class="token builtin class-name">:</span> <span class="token string">"/home/test/tongji.sh"</span>, 
    <span class="token string">"size"</span><span class="token builtin class-name">:</span> <span class="token number">10156</span>, 
    <span class="token string">"state"</span><span class="token builtin class-name">:</span> <span class="token string">"file"</span>, 
    <span class="token string">"uid"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/416afb174f78414d8773763fd6917af3.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" tabindex="0" loading="lazy"><figcaption>åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°</figcaption></figure>
<p>è¿™æ—¶å€™å°±å¯ä»¥çœ‹åˆ°ä¸¤å°æœåŠ¡å™¨ä¸Šéƒ½æœ‰è¿™ä¸ªæ–‡ä»¶äº†ï¼Œå¦‚æœæƒ³è¦å…ˆå¤‡ä»½åœ¨å¤åˆ¶ï¼Œåé¢ä¼šè®²åˆ°å®æˆ˜ï¼›</p>
<hr>
<h3 id="_5-7-file-æ¨¡å—-å¯¹æ–‡ä»¶æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#_5-7-file-æ¨¡å—-å¯¹æ–‡ä»¶æ“ä½œ" aria-hidden="true">#</a> 5.7 file æ¨¡å—ï¼šå¯¹æ–‡ä»¶æ“ä½œ</h3>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-8" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-8"> file æ¨¡å—ï¼šå¯¹æ–‡ä»¶æ“ä½œ</label></li>
</ul>
<p>å¯¹æ–‡ä»¶æ“ä½œï¼Œåˆ›å»ºæ–‡ä»¶æˆ–ç›®å½•ã€åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ã€ä¿®æ”¹æ–‡ä»¶æƒé™</p>
<p><code v-pre>path</code>  æŒ‡å®šè·¯å¾„</p>
<p><code v-pre>src</code>  æºæ–‡ä»¶è·¯å¾„</p>
<p><code v-pre>recurse</code>  é€’å½’æˆæƒ</p>
<p><code v-pre>owner</code>  æŒ‡å®šå±ä¸»</p>
<p><code v-pre>group</code>  æŒ‡å®šå±ç»„</p>
<p><code v-pre>mode</code>   æŒ‡å®šæƒé™</p>
<p><code v-pre>state</code> 	æŒ‡å®šæ–‡ä»¶çš„çŠ¶æ€</p>
<p>â€ƒâ€ƒ<code v-pre>directory</code> â€ƒâ€ƒåœ¨è¿œç«¯åˆ›å»ºç›®å½•</p>
<p>â€ƒâ€ƒ<code v-pre>touch</code>â€ƒâ€ƒåœ¨è¿œç«¯åˆ›å»ºæ–‡ä»¶</p>
<p>â€ƒâ€ƒ<code v-pre>link</code>â€ƒâ€ƒåˆ›å»ºè½¯è¿æ¥</p>
<p>â€ƒâ€ƒ<code v-pre>hard</code>â€ƒâ€ƒåˆ›å»ºç¡¬è¿æ¥</p>
<p>â€ƒâ€ƒ<code v-pre>absent</code>â€ƒâ€ƒè¡¨ç¤ºåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•</p>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible ä¸»æœºç»„åç§° <span class="token parameter variable">-m</span> <span class="token function">file</span> <span class="token parameter variable">-a</span> <span class="token string">"æ“ä½œå†…å®¹"</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># vim /etc/ansible/hosts </span>
<span class="token comment">#é…ç½®è¦æ‰§è¡Œçš„åœ°å€</span>
<span class="token punctuation">[</span>web_group<span class="token punctuation">]</span>
<span class="token number">172.16</span>.11.209
<span class="token number">172.16</span>.10.232

<span class="token punctuation">[</span>web_group:vars<span class="token punctuation">]</span>
<span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123123'</span>

<span class="token comment">#æ‰§è¡Œï¼š</span>
<span class="token comment"># åˆ›å»ºä¸€ä¸ªç›®å½•</span>
ansible web_group <span class="token parameter variable">-m</span> <span class="token function">file</span> <span class="token parameter variable">-a</span> <span class="token string">"path=/home/cs state=directory"</span>

<span class="token comment"># åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</span>
ansible web_group <span class="token parameter variable">-m</span> <span class="token function">file</span> <span class="token parameter variable">-a</span> <span class="token string">"path=/home/cs/cs.sh state=touch"</span>

<span class="token comment"># å°†/home/test/tongji.shè½¯è¿æ¥åˆ°/home/cs/ä¸‹</span>
ansible web_group <span class="token parameter variable">-m</span> <span class="token function">file</span> <span class="token parameter variable">-a</span> <span class="token string">"src=/home/test/tongji.sh path=/home/cs/tongji_link.sh state=link"</span>

<span class="token comment"># åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¹¶ç»™äºˆrootç”¨æˆ·å’Œæ‰§è¡Œæƒé™</span>
ansible web_group <span class="token parameter variable">-m</span> <span class="token function">file</span> <span class="token parameter variable">-a</span> <span class="token string">"path=/home/cs/lv.sh state=touch mode=777 owner=root group=root"</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>
<h3 id="_5-8-service-æ¨¡å—-æ§åˆ¶å¯åŠ¨å…³é—­æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_5-8-service-æ¨¡å—-æ§åˆ¶å¯åŠ¨å…³é—­æœåŠ¡" aria-hidden="true">#</a> 5.8 service æ¨¡å—ï¼šæ§åˆ¶å¯åŠ¨å…³é—­æœåŠ¡</h3>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-9" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-9"> service æ¨¡å—ï¼šæ§åˆ¶å¯åŠ¨å…³é—­æœåŠ¡</label></li>
</ul>
<p><code v-pre>name </code>   å®šä¹‰è¦å¯åŠ¨æœåŠ¡çš„åç§°</p>
<p><code v-pre>state</code>     æŒ‡å®šæœåŠ¡çŠ¶æ€</p>
<p>â€ƒâ€ƒ<code v-pre>started</code>â€ƒå¯åŠ¨æœåŠ¡ï¼ˆå¹‚ç­‰ï¼‰</p>
<p>â€ƒâ€ƒ<code v-pre>stopped</code>â€ƒåœæ­¢æœåŠ¡ï¼ˆå¹‚ç­‰ï¼‰</p>
<p>â€ƒâ€ƒ<code v-pre>restarted</code>â€ƒé‡å¯æœåŠ¡</p>
<p>â€ƒâ€ƒ<code v-pre>reloaded</code>â€ƒé‡è½½æœåŠ¡</p>
<p><code v-pre>enabled</code>    å¼€æœºè‡ªå¯</p>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible ä¸»æœºç»„åç§° <span class="token parameter variable">-m</span> <span class="token function">service</span> <span class="token parameter variable">-a</span> <span class="token string">"name=æœåŠ¡åç§° state=æœåŠ¡æ“ä½œ enabled=æ˜¯å¦è®¾ç½®å¼€æœºè‡ªå¯"</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># vim /etc/ansible/hosts </span>
<span class="token comment">#é…ç½®è¦æ‰§è¡Œçš„åœ°å€</span>
<span class="token punctuation">[</span>web_group<span class="token punctuation">]</span>
<span class="token number">172.16</span>.11.209
<span class="token number">172.16</span>.10.232

<span class="token punctuation">[</span>web_group:vars<span class="token punctuation">]</span>
<span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123123'</span>

<span class="token comment">#æ‰§è¡Œï¼š</span>
<span class="token comment"># å¯ä»¥å…ˆå®‰è£…ä¸€ä¸ªhttpdæœåŠ¡æ¥æµ‹è¯•</span>
ansible web_group <span class="token parameter variable">-m</span> yum <span class="token parameter variable">-a</span> <span class="token string">"name=httpd state=present"</span>

<span class="token comment"># å¯åŠ¨httpdæœåŠ¡</span>
ansible web_group <span class="token parameter variable">-m</span> <span class="token function">service</span> <span class="token parameter variable">-a</span> <span class="token string">"name=httpd state=started"</span>

<span class="token comment"># å…³é—­httpdæœåŠ¡</span>
ansible web_group <span class="token parameter variable">-m</span> <span class="token function">service</span> <span class="token parameter variable">-a</span> <span class="token string">"name=httpd state=stopped"</span>

<span class="token comment"># é‡å¯httpdæœåŠ¡çŠ¶æ€</span>
ansible web_group <span class="token parameter variable">-m</span> <span class="token function">service</span> <span class="token parameter variable">-a</span> <span class="token string">"name=httpd state=restarted"</span>

<span class="token comment"># è®¾ç½®httpdæœåŠ¡å¼€æœºè‡ªå¯</span>
ansible web_group <span class="token parameter variable">-m</span> <span class="token function">service</span> <span class="token parameter variable">-a</span> <span class="token string">"name=httpd state=enabled"</span>

<span class="token comment"># é‡å¯httpdæœåŠ¡å¹¶è®¾ç½®å¼€æœºè‡ªå¯</span>
ansible web_group <span class="token parameter variable">-m</span> <span class="token function">service</span> <span class="token parameter variable">-a</span> <span class="token string">"name=httpd state=restarted enabled=yes"</span>
<span class="token comment"># è®¾ç½®å®Œå¯ä»¥ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹æ˜¯å¦è®¾ç½®äº†å¼€æœºè‡ªå¯</span>
systemctl is-enabled httpd
systemctl list-unit-files <span class="token parameter variable">--type</span><span class="token operator">=</span>service <span class="token parameter variable">--state</span><span class="token operator">=</span>enabled --no-pager <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"enabled"</span> <span class="token operator">|</span> <span class="token function">grep</span> httpd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>
<h3 id="_5-9-cron-æ¨¡å—-å®šæ—¶ä»»åŠ¡" tabindex="-1"><a class="header-anchor" href="#_5-9-cron-æ¨¡å—-å®šæ—¶ä»»åŠ¡" aria-hidden="true">#</a> 5.9 cron æ¨¡å—ï¼šå®šæ—¶ä»»åŠ¡</h3>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-10" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-10"> cron æ¨¡å—ï¼šå®šæ—¶ä»»åŠ¡</label></li>
</ul>
<p><code v-pre>name</code> æ³¨é‡Šè¯´æ˜</p>
<p><code v-pre>minuteã€hourã€dayã€monthã€weekday</code>ï¼ˆåˆ†ã€æ—¶ã€æ—¥ã€æœˆã€å‘¨ï¼‰</p>
<p><code v-pre>user</code>  æŒ‡å®šç”¨æˆ·</p>
<p><code v-pre>job</code>   æ“ä½œçš„æŒ‡ä»¤</p>
<p><code v-pre>state  </code></p>
<p>â€ƒâ€ƒ<code v-pre>present</code>  åˆ›å»º</p>
<p>â€ƒâ€ƒ<code v-pre>absent</code>  åˆ é™¤</p>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible ä¸»æœºç»„åç§° <span class="token parameter variable">-m</span> <span class="token function">cron</span> <span class="token parameter variable">-a</span> <span class="token string">"æ“ä½œå†…å®¹"</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># vim /etc/ansible/hosts </span>
<span class="token comment">#é…ç½®è¦è®¾ç½®çš„åœ°å€</span>
<span class="token punctuation">[</span>web_group<span class="token punctuation">]</span>
<span class="token number">172.16</span>.11.209
<span class="token number">172.16</span>.10.232

<span class="token punctuation">[</span>web_group:vars<span class="token punctuation">]</span>
<span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123123'</span>

<span class="token comment">#æ‰§è¡Œï¼š</span>
<span class="token comment"># ç›´æ¥å†™ä¸€ä¸ªå®šæ—¶ä»»åŠ¡(ä¸å†™æ‰§è¡Œæ—¶é—´ï¼Œé»˜è®¤å°±æ˜¯æ¯åˆ†é’Ÿä¸€æ¬¡ï¼›ä¸å†™nameé»˜è®¤ä¸ºNone);ä¸å»ºè®®ä½¿ç”¨ã€‚</span>
ansible web_group <span class="token parameter variable">-m</span> <span class="token function">cron</span> <span class="token parameter variable">-a</span> <span class="token string">"job='/bin/sh /home/cs/tongji_link.sh'"</span>

<span class="token comment"># æŸ¥çœ‹è®¾ç½®çš„å®šæ—¶ä»»åŠ¡</span>
<span class="token function">crontab</span> <span class="token parameter variable">-l</span>

<span class="token comment"># è®¾ç½®å®šæ—¶æ‰§è¡Œç»Ÿè®¡è„šæœ¬ï¼ˆæ¯ä¸€ä¸ªå°æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œä½¿ç”¨rootç”¨æˆ·ï¼‰</span>
ansible web_group <span class="token parameter variable">-m</span> <span class="token function">cron</span> <span class="token parameter variable">-a</span> <span class="token string">"name="</span>æ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡ç»Ÿè®¡è„šæœ¬<span class="token string">" minute=0 hour=*/1 day=* month=* weekday=* user=root job='/bin/sh /home/cs/tongji_link.sh' state=present"</span>

<span class="token comment"># åˆ é™¤æŒ‡å®šçš„å®šæ—¶ä»»åŠ¡</span>
ansible web_group <span class="token parameter variable">-m</span> <span class="token function">cron</span> <span class="token parameter variable">-a</span> <span class="token string">"name="</span>æ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡ç»Ÿè®¡è„šæœ¬<span class="token string">" minute=0 hour=*/1 day=* month=* weekday=* user=root job='/bin/sh /home/cs/tongji_link.sh' state=absent"</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>
<h3 id="_5-10-mount-æ¨¡å—-ç”¨äºç®¡ç†è®¾å¤‡æŒ‚è½½ä¸å¸è½½" tabindex="-1"><a class="header-anchor" href="#_5-10-mount-æ¨¡å—-ç”¨äºç®¡ç†è®¾å¤‡æŒ‚è½½ä¸å¸è½½" aria-hidden="true">#</a> 5.10 mount æ¨¡å—ï¼šç”¨äºç®¡ç†è®¾å¤‡æŒ‚è½½ä¸å¸è½½</h3>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-11" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-11"> mount æ¨¡å—ï¼šç”¨äºç®¡ç†è®¾å¤‡æŒ‚è½½ä¸å¸è½½</label></li>
</ul>
<blockquote>
<p>mountæ“ä½œéœ€è¦è°¨æ…ï¼Œä¸€ä¸å°å¿ƒä¼šå¯¼è‡´æœåŠ¡å™¨ä¸å¯ä½¿ç”¨ã€‚</p>
</blockquote>
<p><code v-pre>src </code>ï¼šæŒ‡å®šæŒ‚è½½æº</p>
<p><code v-pre>path</code>ï¼šæŒ‡å®šæŒ‚è½½ç‚¹ (æŒ‚è½½ç‚¹ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»º)</p>
<p><code v-pre>fstype</code>ï¼šæŒ‡å®šæ–‡ä»¶ç³»ç»Ÿç±»å‹</p>
<p><code v-pre>opts</code>ï¼šæŒ‚è½½å‚æ•°ï¼Œé»˜è®¤ä¸å†™ä¸ºï¼šdefaults</p>
<p><code v-pre>dump</code>ï¼šæ˜¯å¦å¤‡ä»½ï¼š0è¡¨ç¤ºä¸è¿›è¡Œå¤‡ä»½</p>
<p><code v-pre>passno</code>ï¼šæ–‡ä»¶ç³»ç»Ÿæ£€æµ‹ï¼š0è¡¨ç¤ºä¸è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿæ£€æµ‹</p>
<p><code v-pre>state</code></p>
<p>â€ƒâ€ƒ<code v-pre>present</code>â€ƒâ€ƒå†™å…¥fstabï¼Œä½†å®é™…æ²¡æœ‰æŒ‚è½½ï¼Œéœ€è¦é‡å¯æœåŠ¡å™¨</p>
<p>â€ƒâ€ƒ<code v-pre>absent</code>â€ƒâ€ƒå–æ¶ˆä¸´æ—¶æŒ‚è½½ï¼Œå¹¶ä¸”åˆ é™¤fstab</p>
<p>â€ƒâ€ƒ<code v-pre>mounted</code>â€ƒâ€ƒå†™å…¥fstabï¼Œå¹¶ä¸”ç›´æ¥æŒ‚è½½äº†ï¼ˆå¸¸ç”¨ï¼‰</p>
<p>â€ƒâ€ƒ<code v-pre>unmounted</code>â€ƒâ€ƒä¸´æ—¶å–æ¶ˆæŒ‚è½½ï¼Œä½†æ˜¯æ²¡æœ‰åˆ é™¤fstabï¼Œé‡å¯æœåŠ¡å™¨ä¹‹åå°±ä¼šæ¢å¤ï¼ˆå¸¸ç”¨ï¼‰</p>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible ä¸»æœºç»„åç§° <span class="token parameter variable">-m</span> <span class="token function">mount</span> <span class="token parameter variable">-a</span> <span class="token string">"æ“ä½œå†…å®¹"</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># vim /etc/ansible/hosts </span>
<span class="token comment">#é…ç½®è¦æŒ‚è½½çš„åœ°å€</span>
<span class="token punctuation">[</span>web<span class="token punctuation">]</span>
<span class="token number">172.16</span>.11.209

<span class="token punctuation">[</span>web:vars<span class="token punctuation">]</span>
<span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123123'</span>

<span class="token comment">#æ‰§è¡Œï¼š</span>
<span class="token comment"># ä¸´æ—¶å–æ¶ˆæŒ‚è½½åœ¨dataçš„/dev/sdbï¼ˆå¸¸ç”¨ï¼‰</span>
ansible web <span class="token parameter variable">-m</span> <span class="token function">mount</span> <span class="token parameter variable">-a</span> <span class="token string">"src=/dev/sdb path=/data/ state=unmounted"</span>

<span class="token comment"># å–æ¶ˆæŒ‚è½½åœ¨dataçš„/dev/sdbï¼Œå¹¶ä¸”ç›´æ¥åˆ é™¤fstabä¸­çš„å•ç‹¬é…ç½®ï¼ˆæš‚æ—¶æ²¡æœ‰æˆåŠŸï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰</span>
ansible web <span class="token parameter variable">-m</span> <span class="token function">mount</span> <span class="token parameter variable">-a</span> <span class="token string">"src=/dev/sdb path=/data/ state=absent"</span>

<span class="token comment"># æ·»åŠ ä¸€ä¸ªæŒ‚è½½å†™å…¥fstabï¼Œä½†å®é™…æ²¡æœ‰æŒ‚è½½ï¼Œéœ€è¦é‡å¯æœåŠ¡å™¨ï¼Œé‡å¯å®Œå°±ä¼šè‡ªåŠ¨æŒ‚è½½ä¸Š</span>
ansible web <span class="token parameter variable">-m</span> <span class="token function">mount</span> <span class="token parameter variable">-a</span> <span class="token string">"src=/dev/sdb path=/data fstype=xfs opts=defaults dump=0 passno=0 state=present"</span>

<span class="token comment"># æ·»åŠ ä¸€ä¸ªæŒ‚è½½å†™å…¥fstabï¼Œå¹¶ä¸”ç›´æ¥æŒ‚è½½ä¸Šï¼ˆå¸¸ç”¨ï¼‰</span>
ansible web <span class="token parameter variable">-m</span> <span class="token function">mount</span> <span class="token parameter variable">-a</span> <span class="token string">"src=/dev/sdb path=/data fstype=xfs opts=defaults dump=0 passno=0 state=mounted"</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>
<h3 id="_5-11-user-group-æ¨¡å—-ç”¨äºç®¡ç†çš„ç”¨æˆ·åˆ›å»ºä¸åˆ é™¤" tabindex="-1"><a class="header-anchor" href="#_5-11-user-group-æ¨¡å—-ç”¨äºç®¡ç†çš„ç”¨æˆ·åˆ›å»ºä¸åˆ é™¤" aria-hidden="true">#</a> 5.11 user/group æ¨¡å—ï¼šç”¨äºç®¡ç†çš„ç”¨æˆ·åˆ›å»ºä¸åˆ é™¤</h3>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-12" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-12"> user/group æ¨¡å—ï¼šç”¨äºç®¡ç†çš„ç”¨æˆ·åˆ›å»ºä¸åˆ é™¤</label></li>
</ul>
<blockquote>
<p>userç”¨äºç®¡ç†ç”¨æˆ·çš„åˆ›å»ºä¸åˆ é™¤ï¼Œç›¸å½“äºuseradd,userdel,usermod;</p>
<p>groupæ¨¡å—ç”¨äºç®¡ç†ç”¨æˆ·ç»„çš„ï¼Œç›¸å½“äºgroupadd,groupdelç­‰ã€‚</p>
</blockquote>
<p><code v-pre>name</code>ï¼ˆå¿…éœ€ï¼‰ï¼šæŒ‡å®šç”¨æˆ·çš„ç”¨æˆ·åã€‚</p>
<p><code v-pre>state</code>ï¼šæŒ‡å®šç”¨æˆ·è´¦æˆ·çš„çŠ¶æ€ã€‚å¯ä»¥æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š</p>
<p>â€ƒâ€ƒ<code v-pre>present</code>ï¼šåˆ›å»ºç”¨æˆ·ï¼ˆé»˜è®¤å€¼ï¼‰ã€‚</p>
<p>â€ƒâ€ƒ<code v-pre>absent</code>ï¼šåˆ é™¤ç”¨æˆ·ã€‚</p>
<p>â€ƒâ€ƒ<code v-pre>locked</code>ï¼šé”å®šç”¨æˆ·è´¦æˆ·ã€‚</p>
<p>â€ƒâ€ƒ<code v-pre>unlocked</code>ï¼šè§£é”ç”¨æˆ·è´¦æˆ·ã€‚</p>
<p>â€ƒâ€ƒ<code v-pre>password</code>ï¼šä»…æ›´æ”¹ç”¨æˆ·çš„å¯†ç ã€‚</p>
<p><code v-pre>uid</code>ï¼šæŒ‡å®šç”¨æˆ·çš„ç”¨æˆ·IDï¼ˆUIDï¼‰</p>
<p><code v-pre>gid</code>ï¼š æŒ‡å®šç”¨æˆ·çš„ç”¨æˆ·IDï¼ˆGIDï¼‰</p>
<p><code v-pre>group</code>ï¼šæŒ‡å®šç”¨æˆ·çš„åˆå§‹ä¸»ç»„ã€‚</p>
<p><code v-pre>groups</code>ï¼šæŒ‡å®šç”¨æˆ·æ‰€å±çš„å…¶ä»–ç»„ã€‚</p>
<p><code v-pre>home</code>ï¼šæŒ‡å®šç”¨æˆ·çš„å®¶ç›®å½•è·¯å¾„ã€‚</p>
<p><code v-pre>shell</code>ï¼šæŒ‡å®šç”¨æˆ·çš„ç™»å½• shellã€‚</p>
<p><code v-pre>password</code>ï¼šæŒ‡å®šç”¨æˆ·çš„å¯†ç ï¼ˆå·²åŠ å¯†çš„å¯†ç ï¼‰ã€‚</p>
<p><code v-pre>append</code>ï¼šå¦‚æœä¸º <code v-pre>yes</code>ï¼Œåˆ™æ·»åŠ ç”¨æˆ·åˆ°ç»„è€Œä¸æ˜¯æ›¿æ¢ï¼ˆé»˜è®¤ä¸º <code v-pre>no</code>ï¼‰ã€‚</p>
<p><code v-pre>remove</code>ï¼šå¦‚æœä¸º <code v-pre>yes</code>ï¼Œåˆ™åˆ é™¤ç”¨æˆ·çš„å®¶ç›®å½•å’Œé‚®ç®±æ–‡ä»¶ï¼ˆé»˜è®¤ä¸º <code v-pre>no</code>ï¼‰ã€‚</p>
<p><code v-pre>move_home</code>ï¼šå¦‚æœä¸º <code v-pre>yes</code>ï¼Œåˆ™åœ¨æ›´æ”¹ç”¨æˆ·çš„ä¸»ç›®å½•æ—¶ç§»åŠ¨ç”¨æˆ·çš„æ–‡ä»¶ï¼ˆé»˜è®¤ä¸º <code v-pre>no</code>ï¼‰ã€‚</p>
<p><code v-pre>create_home</code>ï¼šå¦‚æœä¸º <code v-pre>yes</code>ï¼Œåˆ™åˆ›å»ºç”¨æˆ·çš„ä¸»ç›®å½•ï¼ˆé»˜è®¤ä¸º <code v-pre>yes</code>ï¼‰ã€‚</p>
<p><code v-pre>update_password</code>ï¼šå¦‚æœä¸º <code v-pre>always</code>ï¼Œåˆ™å§‹ç»ˆæ›´æ–°å¯†ç ï¼ˆé»˜è®¤ä¸º <code v-pre>on_create</code>ï¼‰ã€‚</p>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible ä¸»æœºç»„åç§° <span class="token parameter variable">-m</span> user <span class="token parameter variable">-a</span> <span class="token string">"æ“ä½œå†…å®¹"</span>
ansible ä¸»æœºç»„åç§° <span class="token parameter variable">-m</span> group <span class="token parameter variable">-a</span> <span class="token string">"æ“ä½œå†…å®¹"</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># vim /etc/ansible/hosts </span>
<span class="token comment">#é…ç½®è¦ç®¡ç†çš„åœ°å€</span>
<span class="token punctuation">[</span>web<span class="token punctuation">]</span>
<span class="token number">172.16</span>.11.209

<span class="token punctuation">[</span>web:vars<span class="token punctuation">]</span>
<span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123123'</span>

<span class="token comment">#æ‰§è¡Œï¼š</span>
<span class="token comment"># åˆ›å»ºç”¨æˆ·ï¼Œä½¿ç”¨ user æ¨¡å—åˆ›å»ºä¸€ä¸ªåä¸º johndoe çš„æ–°ç”¨æˆ·ï¼š</span>
ansible web <span class="token parameter variable">-m</span> user <span class="token parameter variable">-a</span> <span class="token string">"name=johndoe state=present"</span>
<span class="token comment"># æŸ¥çœ‹</span>
<span class="token function">tail</span> <span class="token parameter variable">-1</span> /etc/passwd

<span class="token comment"># åˆ é™¤ç”¨æˆ·ï¼Œä½¿ç”¨ user æ¨¡å—åˆ é™¤ä¸€ä¸ªåä¸º johndoe çš„ç”¨æˆ·ï¼š</span>
ansible web <span class="token parameter variable">-m</span> user <span class="token parameter variable">-a</span> <span class="token string">"name=johndoe state=absent"</span>
<span class="token comment"># åˆ é™¤ç”¨æˆ·å’Œhomeå®¶ç›®å½•ï¼Œä½¿ç”¨ user æ¨¡å—åˆ é™¤ä¸€ä¸ªåä¸º johndoe çš„ç”¨æˆ·ï¼šï¼ˆå¸¸ç”¨ï¼‰</span>
ansible web <span class="token parameter variable">-m</span> user <span class="token parameter variable">-a</span> <span class="token string">"name=johndoe remove=yes state=absent"</span>
<span class="token comment"># æŸ¥çœ‹</span>
<span class="token function">tail</span> <span class="token parameter variable">-1</span> /etc/passwd

<span class="token comment"># åˆ›å»ºç»„ï¼Œä½¿ç”¨ group æ¨¡å—åˆ›å»ºä¸€ä¸ªåä¸º mygroup çš„æ–°ç»„ï¼š</span>
ansible web <span class="token parameter variable">-m</span> group <span class="token parameter variable">-a</span> <span class="token string">"name=mygroup state=present"</span>
<span class="token comment"># æŸ¥çœ‹</span>
<span class="token function">tail</span> <span class="token parameter variable">-1</span> /etc/group

<span class="token comment"># åˆ é™¤ç»„ï¼Œä½¿ç”¨ group æ¨¡å—åˆ é™¤ä¸€ä¸ªåä¸º mygroup çš„ç»„ï¼š</span>
ansible web <span class="token parameter variable">-m</span> group <span class="token parameter variable">-a</span> <span class="token string">"name=mygroup state=absent"</span>
<span class="token comment"># æŸ¥çœ‹</span>
<span class="token function">tail</span> <span class="token parameter variable">-1</span> /etc/group

<span class="token comment"># åœ¨å°†ä¸Šé¢çš„ç”¨æˆ·å’Œç”¨æˆ·ç»„åœ¨åˆ›å»ºä¸€éï¼›</span>
ansible web <span class="token parameter variable">-m</span> user <span class="token parameter variable">-a</span> <span class="token string">"name=johndoe state=present"</span>
ansible web <span class="token parameter variable">-m</span> group <span class="token parameter variable">-a</span> <span class="token string">"name=mygroup state=present"</span>
<span class="token comment"># æ·»åŠ ç”¨æˆ·åˆ°ç»„ï¼Œä½¿ç”¨ user æ¨¡å—å°†ç”¨æˆ· johndoe æ·»åŠ åˆ°ç»„ mygroupï¼š</span>
ansible web <span class="token parameter variable">-m</span> user <span class="token parameter variable">-a</span> <span class="token string">"name=johndoe group=mygroup append=yes"</span>
<span class="token comment"># æŸ¥çœ‹</span>
<span class="token function">tail</span> <span class="token parameter variable">-1</span> /etc/passwd

<span class="token comment"># ä»ç»„ä¸­ç§»é™¤ç”¨æˆ·ï¼Œä½¿ç”¨ user æ¨¡å—ä»ç»„ mygroup ä¸­ç§»é™¤ç”¨æˆ· johndoeï¼š</span>
ansible web <span class="token parameter variable">-m</span> user <span class="token parameter variable">-a</span> <span class="token string">"name=johndoe groups=mygroup append=no"</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œå°±ä¸å†™åŠ åˆ›å»ºå¯†ç çš„äº†ï¼Œå› ä¸ºåˆ›å»ºå¯†ç å¿…é¡»è¦<code v-pre>å“ˆå¸Œå¯†ç </code>ï¼›æˆ‘è¿™è¾¹ç”¨äº†è½¬æ¢æˆå“ˆå¸Œçš„å¯†ç è¿˜æ˜¯ä¸è¡Œï¼Œä¸çŸ¥é“ä¸ºå•¥ï¼›</p>
<p>è¿™é‡Œå†™äº†ä¸€ä¸ªè½¬ä¸º<code v-pre>å“ˆå¸Œå¯†ç </code>çš„pyè„šæœ¬ï¼Œéœ€è¦åœ¨<code v-pre>PyCharm</code>ä¸­è¿è¡Œï¼Œäº¤äº’å¼çš„ï¼›</p>
<div class="language-python line-numbers-mode" data-ext="py"><pre v-pre class="language-python"><code><span class="token keyword">import</span> bcrypt

<span class="token comment"># åŠ å¯†å¯†ç </span>
passwd <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥è¦åŠ å¯†çš„å¯†ç ï¼š"</span><span class="token punctuation">)</span>
password <span class="token operator">=</span> passwd<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
salt <span class="token operator">=</span> bcrypt<span class="token punctuation">.</span>gensalt<span class="token punctuation">(</span><span class="token punctuation">)</span>
hashed_password <span class="token operator">=</span> bcrypt<span class="token punctuation">.</span>hashpw<span class="token punctuation">(</span>password<span class="token punctuation">,</span> salt<span class="token punctuation">)</span>

<span class="token comment"># è¾“å‡ºå“ˆå¸Œå¯†ç </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è½¬æ¢åçš„å“ˆå¸Œå¯†ç ï¼š"</span><span class="token punctuation">,</span> hashed_password<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># éªŒè¯å¯†ç </span>
password_to_check <span class="token operator">=</span> passwd<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> bcrypt<span class="token punctuation">.</span>checkpw<span class="token punctuation">(</span>password_to_check<span class="token punctuation">,</span> hashed_password<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å¯†ç éªŒè¯æˆåŠŸï¼"</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å¯†ç éªŒè¯å¤±è´¥ï¼"</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œè¿˜æ˜¯å»ºè®®å¦‚æœéœ€è¦åŠ å¯†ç æˆ–è€…ä¿®æ”¹å¯†ç ä½¿ç”¨commandã€shellã€rawæ–¹å¼å»æ‰§è¡Œ <code v-pre>passwd ç”¨æˆ·å </code>ä¿®æ”¹ï¼›</p>
<hr>
<h3 id="_5-12-unarchive-æ¨¡å—-è§£å‹ç¼©æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_5-12-unarchive-æ¨¡å—-è§£å‹ç¼©æ¨¡å—" aria-hidden="true">#</a> 5.12 unarchive æ¨¡å—ï¼šè§£å‹ç¼©æ¨¡å—</h3>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-13" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-13"> unarchive è§£å‹ç¼©æ¨¡å—</label></li>
</ul>
<p>è§£å‹ç¼©æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—æœ‰ä¸¤ç§ç”¨æ³•ï¼š</p>
<blockquote>
<ul>
<li>
<p>1ã€å°†ansibleä¸»æœºä¸Šçš„å‹ç¼©åŒ…åœ¨æœ¬åœ°è§£å‹ç¼©åä¼ åˆ°è¿œç¨‹ä¸»æœºä¸Šï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œcopy=yes.æœ¬åœ°è§£å‹ç¼©,è§£å‹ç¼©ä½ç½®ä¸æ˜¯é»˜è®¤çš„ç›®å½•,æ²¡æ‰¾åˆ°æˆ–ä¼ å®Œåˆ äº†åä¼ åˆ°è¿œç¨‹ä¸»æœº</p>
</li>
<li>
<p>2ã€å°†è¿œç¨‹ä¸»æœºä¸Šçš„æŸä¸ªå‹ç¼©åŒ…è§£å‹ç¼©åˆ°æŒ‡å®šè·¯å¾„ä¸‹ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦è®¾ç½®copy=noè¿œç¨‹ä¸»æœºä¸Šé¢çš„æ“ä½œ,ä¸æ¶‰åŠansibleæœåŠ¡ç«¯</p>
</li>
</ul>
</blockquote>
<font color=red>tarã€.tar.gzã€.tar.bz2ã€.zipç­‰éƒ½æ”¯æŒ</font><p><code v-pre>copy</code>  é»˜è®¤ä¸º<code v-pre>no</code>ï¼Œå½“copy=yesï¼Œé‚£ä¹ˆæ‹·è´çš„æ–‡ä»¶æ˜¯ä»ansibleä¸»æœºå¤åˆ¶åˆ°è¿œç¨‹ä¸»æœºä¸Šè€Œä¸æ˜¯åœ¨åŸåœ°è§£å‹ç¼©ï¼Œå¦‚æœè®¾ç½®ä¸ºcopy=noï¼Œé‚£ä¹ˆä¼šåœ¨è¿œç¨‹ä¸»æœºä¸Šå¯»æ‰¾srcæºæ–‡ä»¶;</p>
<p><code v-pre>src</code>   æºè·¯å¾„ï¼Œå¯ä»¥æ˜¯ansibleä¸»æœºä¸Šçš„è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯è¿œç¨‹ä¸»æœºä¸Šçš„è·¯å¾„ï¼Œå¦‚æœæ˜¯è¿œç¨‹ä¸»æœºä¸Šçš„è·¯å¾„ï¼Œåˆ™éœ€è¦è®¾ç½®copy=no</p>
<p><code v-pre>dest</code>  æŒ‡å®šäº†è§£å‹ç¼©åæ–‡ä»¶çš„ç›®æ ‡ç›®å½•</p>
<p><code v-pre>mode</code>  è®¾ç½®è§£å‹ç¼©åçš„æ–‡ä»¶æƒé™ï¼Œå¯ä»¥ä½¿ç”¨æ•°å­—æˆ–ç¬¦å·æ¨¡å¼ï¼Œä¾‹å¦‚ <code v-pre>&quot;0644&quot;</code> æˆ– <code v-pre>&quot;u=rw,go=r&quot;</code>ã€‚</p>
<p><code v-pre>list_files</code>	 é»˜è®¤å€¼ä¸ºno,å¦‚æœè®¾ç½®ä¸ºyesï¼Œè§£å‹åŒæ—¶ï¼Œè¿”å›å‹ç¼©åŒ…çš„æ–‡ä»¶åˆ—è¡¨</p>
<p><code v-pre>remote_src</code>ï¼šå¦‚æœè®¾ç½®ä¸º <code v-pre>yes</code>ï¼Œåˆ™è¡¨ç¤º <code v-pre>src</code> å‚æ•°æ˜¯è¿œç¨‹ä¸»æœºä¸Šçš„è·¯å¾„ã€‚</p>
<p><code v-pre>extra_opts</code>: å…è®¸æ‚¨æŒ‡å®šè§£å‹ç¼©å‘½ä»¤çš„é¢å¤–é€‰é¡¹ã€‚è¿™å¯¹äºä¸€äº›ç‰¹å®šæ ¼å¼çš„å­˜æ¡£æ–‡ä»¶éå¸¸æœ‰ç”¨ã€‚</p>
<p><code v-pre>creates</code>: å¦‚æœæŒ‡å®šäº†æ­¤é€‰é¡¹ï¼Œåªæœ‰åœ¨ <code v-pre>creates</code> ä¸­æŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•ä¸å­˜åœ¨æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œè§£å‹ç¼©æ“ä½œã€‚</p>
<p><code v-pre>owner</code>: è®¾ç½®è§£å‹ç¼©åæ–‡ä»¶çš„æ‰€æœ‰è€…ã€‚</p>
<p><code v-pre>group</code>: è®¾ç½®è§£å‹ç¼©åæ–‡ä»¶çš„æ‰€å±ç»„ã€‚</p>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible ä¸»æœºç»„åç§° <span class="token parameter variable">-m</span> unarchive <span class="token parameter variable">-a</span> <span class="token string">"src=æºè·¯å¾„ dest=ç›®æ ‡è·¯å¾„ å…¶ä»–å‚æ•°"</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># vim /etc/ansible/hosts </span>
<span class="token comment">#é…ç½®è¦è§£å‹çš„åœ°å€</span>
<span class="token punctuation">[</span>web<span class="token punctuation">]</span>
<span class="token number">172.16</span>.11.209

<span class="token punctuation">[</span>web:vars<span class="token punctuation">]</span>
<span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123123'</span>

<span class="token comment">#æ‰§è¡Œï¼š</span>
<span class="token comment"># å°†jdk-8u221-linux-x64.tar.gzå¤åˆ¶åˆ°/home/cs/ä¸‹å¹¶è§£å‹</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># ansible web -m unarchive -a "src=/home/test/jdk-8u221-linux-x64.tar.gz dest=/home/cs/"</span>
<span class="token number">172.16</span>.11.209 <span class="token operator">|</span> CHANGED <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token string">"ansible_facts"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">"discovered_interpreter_python"</span><span class="token builtin class-name">:</span> <span class="token string">"/usr/bin/python"</span>
    <span class="token punctuation">}</span>, 
    <span class="token string">"changed"</span><span class="token builtin class-name">:</span> true, 
    <span class="token string">"dest"</span><span class="token builtin class-name">:</span> <span class="token string">"/home/cs/"</span>, 
    <span class="token string">"extract_results"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">"cmd"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
            <span class="token string">"/usr/bin/gtar"</span>, 
            <span class="token string">"--extract"</span>, 
            <span class="token string">"-C"</span>, 
            <span class="token string">"/home/cs/"</span>, 
            <span class="token string">"-z"</span>, 
            <span class="token string">"-f"</span>, 
            <span class="token string">"/root/.ansible/tmp/ansible-tmp-1697035885.77-18118-31918487585626/source"</span>
        <span class="token punctuation">]</span>, 
        <span class="token string">"err"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>, 
        <span class="token string">"out"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>, 
        <span class="token string">"rc"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span>, 
    <span class="token string">"gid"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>, 
    <span class="token string">"group"</span><span class="token builtin class-name">:</span> <span class="token string">"root"</span>, 
    <span class="token string">"handler"</span><span class="token builtin class-name">:</span> <span class="token string">"TgzArchive"</span>, 
    <span class="token string">"mode"</span><span class="token builtin class-name">:</span> <span class="token string">"0755"</span>, 
    <span class="token string">"owner"</span><span class="token builtin class-name">:</span> <span class="token string">"root"</span>, 
    <span class="token string">"size"</span><span class="token builtin class-name">:</span> <span class="token number">26</span>, 
    <span class="token string">"src"</span><span class="token builtin class-name">:</span> <span class="token string">"/root/.ansible/tmp/ansible-tmp-1697035885.77-18118-31918487585626/source"</span>, 
    <span class="token string">"state"</span><span class="token builtin class-name">:</span> <span class="token string">"directory"</span>, 
    <span class="token string">"uid"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>
<h3 id="_5-13-get-url-æ¨¡å—-ä¸‹è½½æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_5-13-get-url-æ¨¡å—-ä¸‹è½½æ–‡ä»¶" aria-hidden="true">#</a> 5.13 get_url æ¨¡å—ï¼šä¸‹è½½æ–‡ä»¶</h3>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-14" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-14"> get_url æ¨¡å—ï¼šä¸‹è½½æ–‡ä»¶</label></li>
</ul>
<ul>
<li><code v-pre>url</code> (å¿…éœ€): æŒ‡å®šè¦ä¸‹è½½æ–‡ä»¶çš„URLã€‚è¿™æ˜¯ä¸€ä¸ªå¿…éœ€å‚æ•°ã€‚</li>
<li><code v-pre>dest</code> (å¿…éœ€): æŒ‡å®šæ–‡ä»¶å°†ä¿å­˜åˆ°æœ¬åœ°ç›®æ ‡ä¸»æœºä¸Šçš„ç›®æ ‡è·¯å¾„ã€‚è¿™æ˜¯ä¸€ä¸ªå¿…éœ€å‚æ•°ã€‚</li>
<li><code v-pre>force</code> (å¯é€‰): å¦‚æœè®¾ç½®ä¸º <code v-pre>yes</code>ï¼Œå°†å¼ºåˆ¶ä¸‹è½½æ–‡ä»¶ï¼Œå³ä½¿æ–‡ä»¶å·²ç»å­˜åœ¨ã€‚é»˜è®¤ä¸º <code v-pre>no</code>ã€‚</li>
<li><code v-pre>checksum</code> (å¯é€‰): æä¾›è¦ä¸‹è½½æ–‡ä»¶çš„æ ¡éªŒå’Œï¼Œä»¥ç¡®ä¿æ–‡ä»¶å®Œæ•´æ€§ã€‚</li>
<li><code v-pre>backup</code> (å¯é€‰): å¦‚æœè®¾ç½®ä¸º <code v-pre>yes</code>ï¼Œå°†åœ¨ä¸‹è½½ä¹‹å‰å¤‡ä»½ç°æœ‰æ–‡ä»¶ã€‚é»˜è®¤ä¸º <code v-pre>no</code>ã€‚</li>
<li><code v-pre>timeout</code> (å¯é€‰): è®¾ç½®ä¸‹è½½æ–‡ä»¶çš„è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ã€‚</li>
<li><code v-pre>url_username</code> (å¯é€‰): å¦‚æœç›®æ ‡URLéœ€è¦èº«ä»½éªŒè¯ï¼Œå¯ä»¥æä¾›ç”¨æˆ·åã€‚</li>
<li><code v-pre>url_password</code> (å¯é€‰): å¦‚æœç›®æ ‡URLéœ€è¦èº«ä»½éªŒè¯ï¼Œå¯ä»¥æä¾›å¯†ç ã€‚</li>
<li><code v-pre>owner</code> (å¯é€‰): è®¾ç½®ä¸‹è½½åæ–‡ä»¶çš„æ‰€æœ‰è€…ã€‚</li>
<li><code v-pre>group</code> (å¯é€‰): è®¾ç½®ä¸‹è½½åæ–‡ä»¶çš„æ‰€å±ç»„ã€‚</li>
<li><code v-pre>mode</code> (å¯é€‰): è®¾ç½®ä¸‹è½½åæ–‡ä»¶çš„æƒé™æ¨¡å¼ã€‚</li>
</ul>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible ä¸»æœºç»„åç§° <span class="token parameter variable">-m</span> get_url <span class="token parameter variable">-a</span> <span class="token string">"url=è¿œç¨‹ä¸‹è½½çš„url dest=ç›®æ ‡è·¯å¾„ å…¶ä»–å‚æ•°"</span>
ansible web <span class="token parameter variable">-m</span> get_url <span class="token parameter variable">-a</span> <span class="token string">"url=https://example.com/file.txt dest=/path/to/local/file.txt"</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ansible<span class="token punctuation">]</span><span class="token comment"># vim /etc/ansible/hosts </span>
<span class="token comment">#é…ç½®è¦ä¸‹è½½åˆ°çš„åœ°å€</span>
<span class="token punctuation">[</span>web<span class="token punctuation">]</span>
<span class="token number">172.16</span>.11.209

<span class="token punctuation">[</span>web:vars<span class="token punctuation">]</span>
<span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123123'</span>

<span class="token comment">#æ‰§è¡Œï¼š</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># ansible web -m get_url -a "url=https://liucy.blog.csdn.net/article/details/133460612?spm=1001.2014.3001.5502 dest=/home/cs/csdn.txt"</span>
<span class="token number">172.16</span>.11.209 <span class="token operator">|</span> CHANGED <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token string">"ansible_facts"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">"discovered_interpreter_python"</span><span class="token builtin class-name">:</span> <span class="token string">"/usr/bin/python"</span>
    <span class="token punctuation">}</span>, 
    <span class="token string">"changed"</span><span class="token builtin class-name">:</span> true, 
    <span class="token string">"checksum_dest"</span><span class="token builtin class-name">:</span> null, 
    <span class="token string">"checksum_src"</span><span class="token builtin class-name">:</span> <span class="token string">"263c306aaaa75ea1890f33fb846e17c47bac1a7c"</span>, 
    <span class="token string">"dest"</span><span class="token builtin class-name">:</span> <span class="token string">"/home/cs/csdn.txt"</span>, 
    <span class="token string">"elapsed"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>, 
    <span class="token string">"gid"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>, 
    <span class="token string">"group"</span><span class="token builtin class-name">:</span> <span class="token string">"root"</span>, 
    <span class="token string">"md5sum"</span><span class="token builtin class-name">:</span> <span class="token string">"6337bd5bd661d45598c6402652c59e03"</span>, 
    <span class="token string">"mode"</span><span class="token builtin class-name">:</span> <span class="token string">"0644"</span>, 
    <span class="token string">"msg"</span><span class="token builtin class-name">:</span> <span class="token string">"OK (unknown bytes)"</span>, 
    <span class="token string">"owner"</span><span class="token builtin class-name">:</span> <span class="token string">"root"</span>, 
    <span class="token string">"size"</span><span class="token builtin class-name">:</span> <span class="token number">244776</span>, 
    <span class="token string">"src"</span><span class="token builtin class-name">:</span> <span class="token string">"/root/.ansible/tmp/ansible-tmp-1697037340.77-18641-38036675583497/tmp0nw1sp"</span>, 
    <span class="token string">"state"</span><span class="token builtin class-name">:</span> <span class="token string">"file"</span>, 
    <span class="token string">"status_code"</span><span class="token builtin class-name">:</span> <span class="token number">200</span>, 
    <span class="token string">"uid"</span><span class="token builtin class-name">:</span> <span class="token number">0</span>, 
    <span class="token string">"url"</span><span class="token builtin class-name">:</span> <span class="token string">"https://liucy.blog.csdn.net/article/details/133460612?spm=1001.2014.3001.5502"</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr>
<h3 id="_5-14-setup-æ¨¡å—-è·å–ä¸»æœºä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_5-14-setup-æ¨¡å—-è·å–ä¸»æœºä¿¡æ¯" aria-hidden="true">#</a> 5.14 setup æ¨¡å—ï¼šè·å–ä¸»æœºä¿¡æ¯</h3>
<ul class="task-list-container">
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-15" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-15"> setup æ¨¡å—ï¼šè·å–ä¸»æœºä¿¡æ¯</label></li>
</ul>
<p><code v-pre>setup</code> æ¨¡å—ä¸ä»…æ˜¯ä¸€ä¸ªå¸¸è§çš„æ¨¡å—ï¼Œè€Œä¸”æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ¨¡å—ã€‚å®ƒç”¨äºè·å–ç›®æ ‡ä¸»æœºçš„ç³»ç»Ÿä¿¡æ¯å’Œäº‹å®ï¼ˆfactsï¼‰ï¼Œå¹¶å°†è¿™äº›ä¿¡æ¯è¿”å›åˆ° Ansible Playbook ä¸­ï¼Œä»¥ä¾›åç»­ä»»åŠ¡ä½¿ç”¨ã€‚<code v-pre>setup</code> æ¨¡å—é€šå¸¸ä¸éœ€è¦é¢å¤–çš„å‚æ•°ï¼Œå› ä¸ºå®ƒä¼šè‡ªåŠ¨è·å–ç³»ç»Ÿä¿¡æ¯ã€‚</p>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible web <span class="token parameter variable">-m</span> setup
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è·å–çš„ä¿¡æ¯è¾ƒé•¿ï¼Œå¯ä»¥ä½¿ç”¨é‡å®šå‘åˆ°ä¸€ä¸ªç©ºæ–‡ä»¶ä¸­ã€‚</p>
<ul>
<li>å¸¸ç”¨çš„å‡ ä¸ªå‚æ•°ï¼š</li>
</ul>
<div class="language-bash line-numbers-mode" data-ext="sh"><pre v-pre class="language-bash"><code>ansible_all_ipv4_addresses <span class="token comment"># ipv4çš„æ‰€æœ‰åœ°å€</span>
ansible_all_ipv6_addresses <span class="token comment"># ipv6çš„æ‰€æœ‰åœ°å€</span>
ansible_date_time <span class="token comment"># è·å–åˆ°æ§åˆ¶èŠ‚ç‚¹æ—¶é—´</span>
ansible_default_ipv4 <span class="token comment"># é»˜è®¤çš„ipv4åœ°å€</span>
ansible_distribution <span class="token comment"># ç³»ç»Ÿ</span>
ansible_distribution_major_version <span class="token comment"># ç³»ç»Ÿçš„å¤§ç‰ˆæœ¬</span>
ansible_distribution_version <span class="token comment"># ç³»ç»Ÿçš„ç‰ˆæœ¬å·</span>
ansible_domain <span class="token comment">#ç³»ç»Ÿæ‰€åœ¨çš„åŸŸ</span>
ansible_env <span class="token comment">#ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡</span>
ansible_hostname <span class="token comment">#ç³»ç»Ÿçš„ä¸»æœºå</span>
ansible_fqdn <span class="token comment">#ç³»ç»Ÿçš„å…¨å</span>
ansible_machine <span class="token comment">#ç³»ç»Ÿçš„æ¶æ„</span>
ansible_memory_mb <span class="token comment">#ç³»ç»Ÿçš„å†…å­˜ä¿¡æ¯</span>
ansible_os_family <span class="token comment"># ç³»ç»Ÿçš„å®¶æ—</span>
ansible_pkg_mgr <span class="token comment"># ç³»ç»Ÿçš„åŒ…ç®¡ç†å·¥å…·</span>
ansible_processor_cores <span class="token comment">#ç³»ç»Ÿçš„cpuçš„æ ¸æ•°(æ¯é¢—)</span>
ansible_processor_count <span class="token comment">#ç³»ç»Ÿcpuçš„é¢—æ•°</span>
ansible_processor_vcpus <span class="token comment">#ç³»ç»Ÿcpuçš„æ€»ä¸ªæ•°=cpuçš„é¢—æ•°*CPUçš„æ ¸æ•°</span>
ansible_python <span class="token comment"># ç³»ç»Ÿä¸Šçš„python</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‡³æ­¤ï¼ŒAnsibleçš„ad-hocæ¨¡å¼å°±è®²è§£å®Œäº†ï¼Œä¸‹é¢è®²è§£çš„æ˜¯playbookæ¨¡å¼ï¼Œå› ä¸ºplaybookæ¨¡å¼è¦ä½¿ç”¨yamlæ ¼å¼çš„è¯­æ³•ï¼Œæ‰€ä»¥å¯ä»¥å…ˆå»äº†è§£ä¸€ä¸‹yamlè¯­æ³•ï¼›æ¨èï¼š<a href="https://liucy.blog.csdn.net/article/details/129041706" target="_blank" rel="noopener noreferrer">yamlæ–‡ä»¶æ ¼å¼è¯¦è§£åŠå®ä¾‹<ExternalLinkIcon/></a></p>
<h2 id="_6ã€ç›¸å…³æ–‡ç« " tabindex="-1"><a class="header-anchor" href="#_6ã€ç›¸å…³æ–‡ç« " aria-hidden="true">#</a> 6ã€ç›¸å…³æ–‡ç« </h2>
<table>
<thead>
<tr>
<th style="text-align:center">æ–‡ç« æ ‡é¢˜</th>
<th style="text-align:center">æ–‡ç« é“¾æ¥</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://liucy.blog.csdn.net/article/details/133769300" target="_blank" rel="noopener noreferrer">Ansibleè‡ªåŠ¨åŒ–è¿ç»´ï¼ˆä¸€ï¼‰ç®€ä»‹åŠéƒ¨ç½²ã€æ¸…å•<ExternalLinkIcon/></a></td>
<td style="text-align:center"><a href="https://liucy.blog.csdn.net/article/details/133769300" target="_blank" rel="noopener noreferrer">https://liucy.blog.csdn.net/article/details/133769300<ExternalLinkIcon/></a></td>
</tr>
<tr>
<td style="text-align:center"><a href="https://liucy.blog.csdn.net/article/details/133772023" target="_blank" rel="noopener noreferrer">Ansibleè‡ªåŠ¨åŒ–è¿ç»´ï¼ˆäºŒï¼‰ad-hoc æ¨¡å¼è¯¦è§£<ExternalLinkIcon/></a></td>
<td style="text-align:center"><a href="https://liucy.blog.csdn.net/article/details/133772023" target="_blank" rel="noopener noreferrer">https://liucy.blog.csdn.net/article/details/133772023<ExternalLinkIcon/></a></td>
</tr>
<tr>
<td style="text-align:center"><a href="https://liucy.blog.csdn.net/article/details/133899966" target="_blank" rel="noopener noreferrer">Ansibleè‡ªåŠ¨åŒ–è¿ç»´ï¼ˆä¸‰ï¼‰Playbook æ¨¡å¼è¯¦è§£<ExternalLinkIcon/></a></td>
<td style="text-align:center"><a href="https://liucy.blog.csdn.net/article/details/133899966" target="_blank" rel="noopener noreferrer">https://liucy.blog.csdn.net/article/details/133899966<ExternalLinkIcon/></a></td>
</tr>
<tr>
<td style="text-align:center"><a href="https://liucy.blog.csdn.net/article/details/133994509" target="_blank" rel="noopener noreferrer">Ansibleè‡ªåŠ¨åŒ–è¿ç»´ï¼ˆå››ï¼‰jinja2 æ¨¡æ¿ã€Rolesè§’è‰²è¯¦è§£<ExternalLinkIcon/></a></td>
<td style="text-align:center"><a href="https://liucy.blog.csdn.net/article/details/133994509" target="_blank" rel="noopener noreferrer">https://liucy.blog.csdn.net/article/details/133994509<ExternalLinkIcon/></a></td>
</tr>
</tbody>
</table>
</div></template>


