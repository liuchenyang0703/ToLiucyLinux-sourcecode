<template><div><figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161017672.jpeg" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<br>
<br>
<font color=green size=5>ç›¸å…³æ–‡ç« ï¼š</font><blockquote>
<p>ğŸ’» zabbixçš„å®‰è£…éƒ¨ç½²å¯å‚è€ƒï¼š<a href="https://liucy.blog.csdn.net/article/details/124248236" target="_blank" rel="noopener noreferrer">zabbix5.0éƒ¨ç½²ï¼ˆè¶…çº§è¯¦ç»†ï¼‰</a><br></p>
<hr>
<p>ğŸ’» zabbixçš„è„šæœ¬å®‰è£…éƒ¨ç½²å¯å‚è€ƒï¼š<a href="https://download.csdn.net/download/liu_chen_yang/86168600" target="_blank" rel="noopener noreferrer">zabbix5.0ç¦»çº¿è„šæœ¬ä¸€é”®å®‰è£…(åŒ…å«æœåŠ¡ç«¯ã€å®¢æˆ·ç«¯ã€è„šæœ¬å’Œä½¿ç”¨è¯´æ˜)</a><br></p>
<hr>
<p>zabbix5.0è®¾ç½®ä¼ä¸šå¾®ä¿¡å‘Šè­¦ï¼Œé¦–å…ˆéœ€è¦ä¸€ä¸ªä¼ä¸šå¾®ä¿¡ï¼›</p>
</blockquote>
<h2 id="ä¸€ã€é…ç½®ä¼ä¸šå¾®ä¿¡" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€é…ç½®ä¼ä¸šå¾®ä¿¡"><span>ä¸€ã€é…ç½®ä¼ä¸šå¾®ä¿¡</span></a></h2>
<h3 id="_1ã€æ³¨å†Œä¼ä¸šå¾®ä¿¡" tabindex="-1"><a class="header-anchor" href="#_1ã€æ³¨å†Œä¼ä¸šå¾®ä¿¡"><span>1ã€æ³¨å†Œä¼ä¸šå¾®ä¿¡</span></a></h3>
<p><strong><font color=red>â€ƒâ€ƒå¦‚æœéœ€è¦ç”¨å…¬å¸çš„ä¼ä¸šå¾®ä¿¡æ¥åšå‘Šè­¦ä¿¡æ¯çš„æ¥æ”¶è€…ï¼Œé‚£ä¹ˆè¿™ä¸ªæ­¥éª¤å°±å¯ä»¥çœç•¥äº†ã€‚</font></strong></p>
<blockquote>
<p>å¦‚æœæ˜¯åœ¨å…¬å¸ï¼Œç›‘æ§è‡ªå®šä¹‰æœåŠ¡ï¼Œéœ€è¦éƒ¨åˆ†çš„äººå‘˜éƒ½èƒ½çœ‹åˆ°ï¼Œå“ªæœ€å¥½å°±æ˜¯å»æ‰¾å…¬å¸ä¼ä¸šå¾®ä¿¡çš„åˆ›å»ºäººï¼Œå› ä¸ºåé¢ä¼šç”¨åˆ°ä¼ä¸šIDã€‚</p>
</blockquote>
<p>æ²¡æœ‰ä¼ä¸šå¾®ä¿¡æˆ‘ä»¬å¯ä»¥åˆ°è¿™é‡Œæ³¨å†Œä¸€ä¸ªï¼š<a href="https://work.weixin.qq.com/" target="_blank" rel="noopener noreferrer">https://work.weixin.qq.com/</a></p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161017203.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>ä¼ä¸šåç§°å¯å¡«å†™ä¼ä¸šã€æ”¿åºœæˆ–ç»„ç»‡åç§°</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161017732.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>å¡«å†™å®Œæˆä¹‹åç‚¹å‡»æ³¨å†Œå°±å¯ä»¥äº†ï¼›</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161017277.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>æ³¨å†Œå®Œæˆä¹‹åä¹Ÿå¯ä»¥é‚€è¯·åŒäº‹æˆ–è€…åŒå­¦ã€æœ‹å‹è¿›æ¥éƒ½å¯ä»¥ï¼›<br>
æ³¨å†Œå®Œæˆåé€šè¿‡ç½‘é¡µç™»é™†ä¼ä¸šå¾®ä¿¡ï¼ˆ<strong><font color=red>å› ä¸ºä¸€äº›æ“ä½œåªæœ‰é¡µé¢ç®¡ç†èƒ½æ“ä½œ</font></strong>ï¼‰</p>
<h3 id="_2ã€æ·»åŠ éƒ¨é—¨" tabindex="-1"><a class="header-anchor" href="#_2ã€æ·»åŠ éƒ¨é—¨"><span>2ã€æ·»åŠ éƒ¨é—¨</span></a></h3>
<p><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161017194.png" alt="" loading="lazy"><br>
<img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161017100.png" alt="" loading="lazy"><br>
<img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016453.png" alt="" loading="lazy"></p>
<p>æ·»åŠ å®Œéƒ¨é—¨çœ‹ä¸€ä¸‹éƒ¨é—¨Idï¼Œåé¢å†™é…ç½®çš„æ—¶å€™è¦ç”¨åˆ°ã€‚</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016654.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<h3 id="_3ã€æ·»åŠ éƒ¨é—¨æˆå‘˜" tabindex="-1"><a class="header-anchor" href="#_3ã€æ·»åŠ éƒ¨é—¨æˆå‘˜"><span>3ã€æ·»åŠ éƒ¨é—¨æˆå‘˜</span></a></h3>
<blockquote>
<p>å¯ä»¥æ–‡ä»¶å¯¼å…¥ï¼Œä¹Ÿå¯ä»¥ä»å…¶ä»–éƒ¨é—¨ç§»å…¥ï¼Œä¹Ÿå¯ä»¥è‡ªå·±æ·»åŠ æˆå‘˜ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å°±æ¥è‡ªå·±æ·»åŠ å§ï¼›</p>
<p><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016038.png" alt="" loading="lazy"><br>
<img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016744.png" alt="" loading="lazy"></p>
<p>å®Œæˆä¹‹åå¯ç»§ç»­æ·»åŠ ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¿å­˜ï¼›</p>
<p><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016492.png" alt="" loading="lazy"><br>
<img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016859.png" alt="" loading="lazy"></p>
<h3 id="_4ã€è‡ªå»ºåº”ç”¨-ç”¨æ¥å‘Šè­¦é€šçŸ¥çš„" tabindex="-1"><a class="header-anchor" href="#_4ã€è‡ªå»ºåº”ç”¨-ç”¨æ¥å‘Šè­¦é€šçŸ¥çš„"><span>4ã€è‡ªå»ºåº”ç”¨ï¼ˆç”¨æ¥å‘Šè­¦é€šçŸ¥çš„ï¼‰</span></a></h3>
<p>é€‰æ‹©åº”ç”¨ç®¡ç†----&gt;é€‰æ‹©è‡ªå»ºåº”ç”¨ï¼ˆæ”¯æŒå°ç¨‹åºï¼‰</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016430.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>åˆ›å»ºåº”ç”¨ï¼›</p>
<blockquote>
<ul>
<li>â€ƒlogoå¯ä»¥è‡ªå·±å»ç½‘ä¸ŠæŸ¥æ‰¾æˆ–è€…è‡ªå·±åšä¸€ä¸ªï¼›</li>
<li>â€ƒåº”ç”¨åç§°å¯ä»¥è‡ªå·±å®šä¹‰ï¼Œæˆ‘å®šä¹‰çš„å°±æ˜¯â€zabbixç›‘æ§â€œï¼›</li>
<li>â€ƒåº”ç”¨ä»‹ç»å¯ä»¥ä¸å¡«ï¼Œçœ‹è‡ªå·±æƒ…å†µï¼›</li>
<li>â€ƒå¯è§èŒƒå›´ï¼Œé€‰æ‹©åˆšåˆšåˆ›å»ºçš„éƒ¨é—¨å³å¯ã€‚</li>
</ul>
</blockquote>
<p><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016360.png" alt="" loading="lazy"><br>
<img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016889.png" alt="" loading="lazy"></p>
<p>åˆ›å»ºæˆåŠŸæŸ¥çœ‹</p>
<blockquote>
<p>â€ƒâ€ƒè¦è®°ä½idï¼Œåç»­è¿˜éœ€è¦secretï¼Œåˆ°æ—¶å€™æŸ¥çœ‹æŒ‰ç…§æ­¥éª¤åšå°±å¯ä»¥äº†ã€‚</p>
</blockquote>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016559.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>ç‚¹å‡»æŸ¥çœ‹Secret</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016970.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>ç‚¹å‡»å‘é€ååœ¨ä¼ä¸šå¾®ä¿¡å†…ä¼šæœ‰ä¿¡æ¯ï¼Œç‚¹å‡»æŸ¥çœ‹Secret</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016634.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>ç‚¹å‡»å‰å¾€æŸ¥çœ‹ï¼›è®°ä¸‹æ¥ï¼Œåç»­è¦ç”¨åˆ°ï¼›</p>
<p><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016977.png" alt="" loading="lazy"><br>
é¡ºä¾¿æŸ¥çœ‹ä¸€ä¸‹ä¼ä¸šçš„IDï¼Œåç»­éœ€è¦ç”¨åˆ°ï¼›</p>
<blockquote>
<p>â€ƒâ€ƒç‚¹å‡»æˆ‘çš„ä¼ä¸š---&gt;ä¼ä¸šä¿¡æ¯---&gt;æœ€ä¸‹é¢æœ‰ä¸€ä¸ªä¼ä¸šIDï¼›ï¼ˆè¿™ä¸ªæ˜¯éœ€è¦è®°ä½çš„ï¼Œåç»­è¦ä½¿ç”¨ï¼‰ã€‚</p>
</blockquote>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016841.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<h2 id="äºŒã€é…ç½®zabbixæœåŠ¡ç«¯-zabbix-server" tabindex="-1"><a class="header-anchor" href="#äºŒã€é…ç½®zabbixæœåŠ¡ç«¯-zabbix-server"><span>äºŒã€é…ç½®zabbixæœåŠ¡ç«¯ï¼ˆzabbix-serverï¼‰</span></a></h2>
<br>
<h3 id="_1ã€ç¼–è¾‘zabbix-server-confæ–‡ä»¶è¿›è¡Œé…ç½®" tabindex="-1"><a class="header-anchor" href="#_1ã€ç¼–è¾‘zabbix-server-confæ–‡ä»¶è¿›è¡Œé…ç½®"><span>1ã€ç¼–è¾‘zabbix-server.confæ–‡ä»¶è¿›è¡Œé…ç½®</span></a></h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#è¿›å…¥zabbix_serveré…ç½®æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /etc/zabbix/zabbix_server.conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#é»˜è®¤523è¡Œä¼šæœ‰è¿™æ¡ï¼Œè¿™é‡Œæ˜¯å­˜æ”¾è„šæœ¬çš„ä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75">AlertScriptsPath</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">/usr/lib/zabbix/alertscripts</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2ã€å®‰è£…ç»„ä»¶requests" tabindex="-1"><a class="header-anchor" href="#_2ã€å®‰è£…ç»„ä»¶requests"><span>2ã€å®‰è£…ç»„ä»¶requests</span></a></h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">yum</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> python-requests</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div></div></div><h3 id="_3ã€å¾®ä¿¡æŠ¥è­¦è„šæœ¬" tabindex="-1"><a class="header-anchor" href="#_3ã€å¾®ä¿¡æŠ¥è­¦è„šæœ¬"><span>3ã€å¾®ä¿¡æŠ¥è­¦è„šæœ¬</span></a></h3>
<blockquote>
<p>ä¸‹è½½åœ°å€ï¼š<a href="https://download.csdn.net/download/liu_chen_yang/86087478" target="_blank" rel="noopener noreferrer">zabbixå¾®ä¿¡å‘Šè­¦.py</a></p>
</blockquote>
<p>åœ¨/usr/lib/zabbix/alertscriptsç›®å½•ä¸‹æ“ä½œï¼›</p>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#è¿›å…¥/usr/lib/zabbix/alertscripts</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/lib/zabbix/alertscripts</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#åˆ›å»ºä¸€ä¸ªpythonè„šæœ¬</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> weixin.py</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¤åˆ¶ä¸‹é¢çš„è„šæœ¬ç²˜è´´ä¸Šå»å³å¯ï¼›</p>
<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#!/usr/bin/python</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#_*_coding:utf-8 _*_</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> urllib,urllib2</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> json</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> sys</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> simplejson</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> base64</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> hashlib</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">reload</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">sys.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">setdefaultencoding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'utf-8'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> gettoken</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic">corpid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic">corpsecret</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    gettoken_url </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid='</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> corpid </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '&#x26;corpsecret='</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> corpsecret</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">  gettoken_url</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        token_file </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> urllib2.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">urlopen</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(gettoken_url)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    except</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> urllib2.HTTPError </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> e:</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> e.code</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> e.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">read</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">decode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"utf8"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        sys.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">exit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    token_data </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> token_file.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">read</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">().</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">decode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'utf-8'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    token_json </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> json.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">loads</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(token_data)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    token_json.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">keys</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    token </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> token_json[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'access_token'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">]</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(token)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> token</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF"> senddata</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic">access_token</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic">user</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic">subject</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic">content</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">):</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">    with</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> open</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'/usr/lib/zabbix/alertscripts/graph/bg.png'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">mode</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'rb'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> f:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">       png </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> f.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">read</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    png_md5 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> hashlib.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">md5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    png_64 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> base64.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">b16encode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(png)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    send_url </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> 'https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token='</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> access_token</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    send_values </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        "touser"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> : </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"@all"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,   </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#ä¼ä¸šå·ä¸­çš„ç”¨æˆ·å¸å·ï¼Œåœ¨zabbixç”¨æˆ·Mediaä¸­é…ç½®ï¼Œå¦‚æœé…ç½®ä¸æ­£å¸¸ï¼Œå°†æŒ‰éƒ¨é—¨å‘é€ã€‚</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        "toparty"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"2"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,    </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#ä¼ä¸šå·ä¸­çš„éƒ¨é—¨idã€‚</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        "msgtype"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"text"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">, </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#æ¶ˆæ¯ç±»å‹ã€‚</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        "agentid"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"100035"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">,    </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#ä¼ä¸šå·ä¸­çš„åº”ç”¨idã€‚</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        "text"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:{</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">            "content"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:subject </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> content</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">           },</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">        "safe"</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">"0"</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#    send_data = json.dumps(send_values, ensure_ascii=False)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    send_data </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> simplejson.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">dumps</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(send_values, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">ensure_ascii</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">False</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">encode</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">'utf-8'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    send_request </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> urllib2.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">Request</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(send_url, send_data)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    response </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> json.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">loads</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(urllib2.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">urlopen</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(send_request).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">read</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">())</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2">    print</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(response)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '__main__'</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    user </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">])     </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#zabbixä¼ è¿‡æ¥çš„ç¬¬ä¸€ä¸ªå‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    subject </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">])  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#zabbixä¼ è¿‡æ¥çš„ç¬¬äºŒä¸ªå‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    content </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(sys.argv[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">])  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#zabbixä¼ è¿‡æ¥çš„ç¬¬ä¸‰ä¸ªå‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF"> </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    corpid </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379">  '22jsaooasbf23934'</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">   #CorpIDæ˜¯ä¼ä¸šå·çš„æ ‡è¯†</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    corpsecret </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> '410Jsk8_4lvCQYmdo92-sdfafsadfasdfxzc'</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">  #corpsecretSecretæ˜¯ç®¡ç†ç»„å‡­è¯å¯†é’¥</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">    accesstoken </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF"> gettoken</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(corpid,corpsecret)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF">    senddata</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">(accesstoken,user,subject,content)</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„é‡Œé¢è¦ä¿®æ”¹çš„åœ°æ–¹ï¼›ï¼ˆä¸Šé¢è¯´è¿‡äº†å‡ å¤„åœ°æ–¹æ˜¯éœ€è¦æ³¨æ„çš„åé¢éœ€è¦ç”¨åˆ°ï¼Œç°åœ¨å°±å¯ä»¥ç”¨åˆ°äº†ï¼‰ï¼›</p>
<blockquote>
<p>éœ€è¦ä¿®æ”¹çš„åœ°æ–¹æœ‰ï¼š<br>
<br></p>
<ul>
<li>ç¬¬40è¡Œ:â€ƒ &quot;toparty&quot;:&quot;2&quot;,    #ä¼ä¸šéƒ¨é—¨idã€‚</li>
<li>ç¬¬42è¡Œï¼šâ€ƒ&quot;agentid&quot;:&quot;100035&quot;,    #ä¼ä¸šå·ä¸­çš„åº”ç”¨idã€‚</li>
<li>ç¬¬61è¡Œï¼šâ€ƒcorpid =  '22jsaooasbf23934'   #CorpIDæ˜¯ä¼ä¸šå·çš„æ ‡è¯†</li>
<li>ç¬¬62è¡Œï¼šâ€ƒcorpsecret = '410Jsk8_4lvCQYmdo92-sdfafsadfasdfxzc'  #corpsecretSecretæ˜¯ç®¡ç†ç»„å‡­è¯å¯†é’¥</li>
</ul>
</blockquote>
<p>ä¼ä¸šéƒ¨é—¨çš„id</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016347.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>ä¼ä¸šå·ä¸­çš„åº”ç”¨id</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016113.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>CorpIDæ˜¯ä¼ä¸šå·çš„æ ‡è¯†ï¼ˆä¼ä¸šçš„idï¼‰</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016951.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>ç®¡ç†ç»„å‡­è¯å¯†é’¥ï¼ˆåº”ç”¨çš„Secretï¼Œåœ¨åº”ç”¨ç®¡ç†ä¸­ï¼‰</p>
<blockquote>
<p>é‡åˆ°è¿‡æœŸçš„è¯é‡æ–°å‘é€ä¸€ä¸‹å°±å¯ä»¥ï¼›</p>
</blockquote>
<p><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161016745.png" alt="" loading="lazy"><br>
<img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015758.png" alt="" loading="lazy"></p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015273.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>æ›´æ¢å¥½ä¹‹åï¼Œä¿å­˜é€€å‡ºå³å¯ï¼›</p>
<h3 id="_4ã€æµ‹è¯•è„šæœ¬æ˜¯å¦å¯ç”¨" tabindex="-1"><a class="header-anchor" href="#_4ã€æµ‹è¯•è„šæœ¬æ˜¯å¦å¯ç”¨"><span>4ã€æµ‹è¯•è„šæœ¬æ˜¯å¦å¯ç”¨</span></a></h3>
<div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34"><pre v-pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF">python</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> /usr/lib/zabbix/alertscripts/weixin.py</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> aaabbbccc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379"> abc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66"> 1234</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF">{u'msgid': u'mrVtVXE39it1tWVvd57npP-C0Y8uy8F_-hstvi9e_Y0gSghmqd6IOO4SWKCTeFNyUYjV8TgdE3IXSGC3g2w_oQ', u'errcode': 0, u'errmsg': u'ok'}</span></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ä¸‰ã€é…ç½®zabbix-webç«¯" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€é…ç½®zabbix-webç«¯"><span>ä¸‰ã€é…ç½®zabbix webç«¯</span></a></h2>
<br>
<blockquote>
<p>å› ä¸ºä¹‹å‰æˆ‘å·²ç»æŠŠç›‘æ§é¡¹å’Œè§¦å‘å™¨å¼„å¥½äº†ï¼Œæ‰€ä»¥ï¼Œç›´æ¥é…ç½®æŠ¥è­¦åª’ä»‹ç±»å‹å°±å¥½äº†ã€‚</p>
</blockquote>
<p>å¯ä»¥å‚è€ƒï¼š<a href="https://liucy.blog.csdn.net/article/details/124101253" target="_blank" rel="noopener noreferrer">zabbixæ·»åŠ è‡ªå®šä¹‰ç›‘æ§é¡¹&amp;å‘Šè­¦ï¼ˆé‚®ä»¶ï¼‰</a></p>
<h3 id="_1ã€é…ç½®æŠ¥è­¦åª’ä»‹ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_1ã€é…ç½®æŠ¥è­¦åª’ä»‹ç±»å‹"><span>1ã€é…ç½®æŠ¥è­¦åª’ä»‹ç±»å‹</span></a></h3>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015834.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>è„šæœ¬åç§°ä¸€å®šè¦å’Œalertscriptsç›®å½•ä¸‹æ”¾çš„ä¸€æ ·ï¼›</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015334.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>å®Œæˆä¹‹åå¤–é¢æœ‰ä¸€ä¸ªæµ‹è¯•ï¼ˆzabbix5.0ä»¥åŠä»¥åæ‰æœ‰ï¼‰</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015046.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>æ”¶ä»¶äººâ€œ@allâ€å°±å¯ä»¥</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015853.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>å¦‚æœæœ‰æŠ¥é”™ï¼Œå°±è§£å†³ä¸€ä¸‹æŠ¥é”™ï¼›æ²¡æœ‰çš„è¯å°±ç›´æ¥å»ä¼ä¸šå¾®ä¿¡çœ‹çœ‹èƒ½æ”¶åˆ°ä¿¡æ¯å˜›<br>
ï¼›<br>
<img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015688.png" alt="" loading="lazy"></p>
<p>è¿™æ ·å°±æ˜¯å‘é€æˆåŠŸäº†ï¼Œæˆ‘ä»¬å»ä¼ä¸šå¾®ä¿¡çœ‹ä¸€ä¸‹ï¼›</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015420.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>å¯ä»¥çœ‹åˆ°æ¶ˆæ¯å·²ç»å‘é€è¿‡æ¥äº†ã€‚</p>
<p>ä½¿æ‰€æœ‰çš„å‘Šè­¦ä¿¡æ¯éƒ½å‘é€åˆ°ä¼ä¸šå¾®ä¿¡çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å¾€ä¸‹çœ‹ï¼›</p>
<h3 id="_2ã€é…ç½®åŠ¨ä½œ" tabindex="-1"><a class="header-anchor" href="#_2ã€é…ç½®åŠ¨ä½œ"><span>2ã€é…ç½®åŠ¨ä½œ</span></a></h3>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015344.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>åç§°è‡ªå·±èµ·ä¸€ä¸ªå°±å¥½äº†ï¼›</p>
<p><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015069.png" alt="" loading="lazy"><br>
<img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015809.png" alt="" loading="lazy"></p>
<p>ä»…é€åˆ°é€‰æ‹©æ‰€æœ‰å°±å¯ä»¥ï¼š</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015030.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>æ¢å¤æ“ä½œé€‰æ‹©â€œé€šçŸ¥æ‰€æœ‰å‚ä¸è€…â€å°±å¯ä»¥ï¼›</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015255.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>åŠ¨ä½œè®¾ç½®å®Œæˆï¼Œå»è®¾ç½®ç”¨æˆ·ï¼›</p>
<h3 id="_3ã€é…ç½®ç”¨æˆ·" tabindex="-1"><a class="header-anchor" href="#_3ã€é…ç½®ç”¨æˆ·"><span>3ã€é…ç½®ç”¨æˆ·</span></a></h3>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015262.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>é€‰æ‹©æŠ¥è­¦åª’ä»‹---&gt;ç‚¹å‡»æ·»åŠ </p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015382.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>é€‰æ‹©weixinå³å¯ï¼›æ”¶ä»¶äººè¿˜æ˜¯â€œ@allâ€ï¼›</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015187.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<p>æ·»åŠ å®Œæˆä¹‹åä¸€å®šè¦ç‚¹å‡»æ›´æ–°ï¼›</p>
<figure><img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015890.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>
<h3 id="_4ã€æµ‹è¯•å‘é€å‘Šè­¦" tabindex="-1"><a class="header-anchor" href="#_4ã€æµ‹è¯•å‘é€å‘Šè­¦"><span>4ã€æµ‹è¯•å‘é€å‘Šè­¦</span></a></h3>
<p>æˆåŠŸæ¥æ”¶åˆ°å‘Šè­¦ï¼›<br>
<img src="https://lcy-blog.oss-cn-beijing.aliyuncs.com/blog/202412161015736.png" alt="" loading="lazy"><br>
è‡³æ­¤zabbix5.0é…ç½®ä¼ä¸šå¾®ä¿¡å‘Šè­¦å°±å®Œæˆäº†ã€‚</p>
</div></template>


